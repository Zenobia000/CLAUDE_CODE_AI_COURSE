# 模組 6：多代理人協作與 MCP - 解鎖 AI 工作流程編排的終極力量

## 🌟 模組定位：從單打獨鬥到團隊協作

> **這不是「學習一個協議」，而是「建構 AI 自動化帝國」的關鍵轉折。**

在前面的模組中，你學會了如何使用 Claude Code。但現在，我們要讓 Claude Code 成為「指揮家」，協調多個 AI Agent 與外部系統，自動化複雜的工作流程。

### 為什麼這個模組如此重要？

想像一下：
- ❌ **過去**：你手動從 GitHub 複製 issues → 手動貼到 Notion → 手動發 Slack 通知 → 手動寫週報
- ✅ **現在**：一個指令，4 個 MCP 自動協作，10 分鐘內生成完整週報並自動分發

### Linux 學習類比

- **MCP** 就像 Linux 的 `mount` 指令：將外部系統「掛載」到 Claude Code
- **Agent 切換**就像 `sudo -u`：切換到不同專家身份
- **工作流程編排**就像 Shell Script：串聯多個操作，一次執行

---

## 📊 模組概覽

### 學習時間
- **核心理論**：1.5 小時
  - 6.1 MCP 協議深入：30 分鐘
  - 6.2 多代理人編排實戰：60 分鐘
- **情境練習**：5-8 小時（基礎 + 組合級）
- **深度實作**：10-15 小時（自訂 MCP 開發）
- **總計**：16.5-24.5 小時

### 內容統計
- **理論文件**：2 篇（1,700+ 行）
- **情境題庫**：15 題（基礎 5 + 組合 8 + 複雜 2）
- **完整示範情境**：2 個（配置 GitHub MCP + 自動化週報系統）
- **實作練習**：2 個（多 MCP 整合 + 自訂 MCP 開發）
- **MCP 配置範本**：4+ 個可執行範本

---

## 🎯 學習目標

### 知識層面（Know）
完成本模組後，你將理解：
- [ ] MCP（Model Context Protocol）的架構與設計哲學
- [ ] MCP 與傳統 API 的本質差異
- [ ] 多代理人協作的四種編排模式
- [ ] Agent 切換的成本與策略
- [ ] MCP 安全與治理最佳實踐
- [ ] 10+ 個常用的 MCP servers 及其應用場景

### 技能層面（Do）
完成本模組後，你將能夠：
- [ ] 配置並使用 GitHub、Database、Slack、Notion MCP
- [ ] 設計串行、並行、條件分支、循環工作流程
- [ ] 建立自動化週報系統（4 MCP 協同）
- [ ] 開發簡單的自訂 MCP server
- [ ] 診斷 MCP 連線與授權問題
- [ ] 設計企業級的 AI 自動化流程

### 思維層面（Be）
完成本模組後，你的思維將轉變為：
- [ ] 從「使用工具」變成「編排工作流程」
- [ ] 從「單點自動化」變成「系統化自動化」
- [ ] 從「重複勞動」變成「一鍵執行」
- [ ] 從「個人效率」變成「團隊賦能」

---

## 📁 內容結構

```
06_多代理人協作與MCP/
├── 📘 理論/                                    # 核心概念
│   ├── 6.1_MCP協議深入.md                      # MCP 架構、安全、治理（800+ 行）
│   └── 6.2_多代理人編排實戰.md                  # 工作流程編排模式（900+ 行）
│
├── 🎮 情境題庫/                                # 15 個實戰情境
│   ├── README.md                              # 題庫總覽與學習路徑（500+ 行）
│   ├── 基礎級/                                 # 5 題（30-45 分鐘/題）
│   │   ├── B01_配置GitHub_MCP.md              # ⭐ 完整示範（400+ 行）
│   │   ├── B02_配置Database_MCP.md
│   │   ├── B03_配置Slack_MCP.md
│   │   ├── B04_配置Notion_MCP.md
│   │   └── B05_基礎Agent切換.md
│   │
│   ├── 組合級/                                 # 8 題（1-2.5 小時/題）
│   │   ├── C01_自動化週報生成系統.md           # ⭐ 完整示範（800+ 行）
│   │   ├── C02_知識萃取系統.md
│   │   ├── C03_自動化CI_CD觸發器.md
│   │   ├── C04_多資料庫同步系統.md
│   │   ├── C05_智能通知分發系統.md
│   │   ├── C06_文檔自動更新流程.md
│   │   ├── C07_Bug追蹤自動化.md
│   │   └── C08_團隊協作儀表板.md
│   │
│   └── 複雜級/                                 # 2 題（8-15 小時/專案）
│       ├── E01_企業級DevOps自動化平台.md
│       └── E02_跨平台知識管理系統.md
│
├── 💻 實作/                                    # 2 個深度練習
│   ├── 練習1_多MCP整合/
│   │   ├── README.md                          # 個人知識管理系統（400+ 行）
│   │   ├── 情境描述.md
│   │   ├── 起始配置範本/
│   │   ├── 參考解答/
│   │   └── 評量標準.md
│   │
│   └── 練習2_自訂MCP開發/
│       ├── README.md                          # Weather API MCP（400+ 行）
│       ├── 開發指南.md
│       ├── 起始程式碼/
│       ├── 參考實作/
│       └── 測試與除錯.md
│
├── 🔧 範例配置/                                # MCP 配置範本庫
│   ├── README.md                              # 範本使用指南（300+ 行）
│   └── mcp_templates/
│       ├── github-mcp.json                    # GitHub MCP 配置
│       ├── database-mcp.json                  # PostgreSQL/MySQL 配置
│       ├── slack-notion-mcp.json              # Slack + Notion 配置
│       └── full-stack-dev.json                # 完整開發環境配置
│
├── 📇 記憶卡庫/                                # 情境式記憶卡
│   └── README.md                              # 6 大類記憶卡架構（400+ 行）
│
└── 📝 作業/
    └── 作業說明.md                             # 實戰作業
```

---

## 📚 學習路徑：1.5 小時核心理論

### 第 1 步：理解 MCP 的本質（30 分鐘）

**閱讀**：`理論/6.1_MCP協議深入.md`

**關鍵問題**：
- MCP 解決了什麼問題？
- 為什麼 MCP 不是普通的 API？
- 如何配置 `.claude/mcp-config.json`？
- 常用的 MCP servers 有哪些？
- MCP 的安全與治理最佳實踐是什麼？

**學習檢查點**：
- [ ] 能說明 MCP 的三層架構（Protocol、Transport、Security）
- [ ] 理解 MCP 與 REST API 的 5 個核心差異
- [ ] 能手動配置一個 GitHub MCP
- [ ] 知道如何管理 API keys 與權限
- [ ] 能診斷常見的 MCP 連線問題

**實踐練習**：
- 配置 GitHub MCP 並讀取你的 repositories
- 配置 Database MCP 並查詢測試資料庫
- 查看 `.claude/mcp-config.json` 的結構

---

### 第 2 步：掌握多代理人編排（60 分鐘）

**閱讀**：`理論/6.2_多代理人編排實戰.md`

**關鍵問題**：
- 多代理人協作的四種模式是什麼？
- 何時應該切換 Agent？切換成本是什麼？
- 如何設計一個自動化週報系統？
- 錯誤處理與回退機制如何實現？
- AI Agent 與 MCP 如何配合使用？

**學習檢查點**：
- [ ] 能說明串行、並行、條件分支、循環四種模式
- [ ] 理解 Agent 切換的決策樹
- [ ] 能設計一個 4-MCP 協同的工作流程
- [ ] 知道如何處理 MCP 調用失敗
- [ ] 能用 `/agents` 指令切換專家角色

**實踐練習**：
- 跟著「自動化週報系統」範例實作
- 設計一個知識萃取系統的工作流程
- 體驗 Agent 切換與 MCP 協作的完整流程

---

## 🚀 進階學習路徑

### 情境練習建議順序

#### Phase 1：基礎 MCP 配置（2-3 小時）
1. **B01_配置GitHub_MCP** ⭐ 必做
   - 學習 OAuth 授權流程
   - 掌握 GitHub MCP 的核心功能

2. **B02_配置Database_MCP**
   - 學習資料庫連線配置
   - 掌握 SQL 查詢與 MCP 的整合

3. **B03_配置Slack_MCP**
   - 學習 Webhook 配置
   - 掌握訊息發送與接收

#### Phase 2：多 MCP 協同（3-5 小時）
4. **C01_自動化週報生成系統** ⭐ 必做
   - 綜合運用 4 個 MCP
   - 掌握串行與並行模式

5. **C02_知識萃取系統**
   - Web Scraping + Notion + Anki
   - 掌握條件分支模式

6. **C05_智能通知分發系統**
   - 多平台通知整合
   - 掌握循環模式

#### Phase 3：自訂開發（10-15 小時）
7. **練習2_自訂MCP開發**
   - 開發 Weather API MCP
   - 學習 MCP server 架構

8. **E01_企業級DevOps自動化平台**（可選）
   - 挑戰複雜級專案
   - 整合 CI/CD、監控、通知、文檔

---

## 🎯 學習成果驗證

### Level 1：基礎配置（必須達成）
- [ ] 成功配置 3+ 個 MCP servers
- [ ] 理解 MCP 配置檔的結構
- [ ] 能診斷常見的連線問題
- [ ] 知道如何管理 API keys

### Level 2：工作流程編排（推薦達成）
- [ ] 設計並實現一個 2-MCP 協同的自動化流程
- [ ] 理解四種編排模式的應用場景
- [ ] 能處理 MCP 調用失敗的情況
- [ ] 會使用 Agent 切換來提升輸出品質

### Level 3：企業級應用（進階目標）
- [ ] 開發一個簡單的自訂 MCP server
- [ ] 設計 4+ MCP 協同的複雜工作流程
- [ ] 建立完整的錯誤處理與日誌系統
- [ ] 為團隊設計 AI 自動化平台

---

## 💡 學習建議

### 核心理念
1. **從問題出發**：不要為了用 MCP 而用 MCP，先找到真正的痛點
2. **小步快跑**：先配置一個 MCP，確保能用，再加第二個
3. **實戰驅動**：每學一個概念，立刻在真實專案中應用
4. **安全第一**：API keys 管理不能馬虎，一開始就建立好習慣

### 常見陷阱與解法

#### 陷阱 1：MCP 配置爆炸
**問題**：一次配置 10 個 MCP，結果全部失敗，不知道哪裡出錯。

**解法**：
- 一次只配置一個 MCP
- 測試通過後再加下一個
- 每個 MCP 獨立驗證功能

#### 陷阱 2：過度編排
**問題**：設計了超複雜的工作流程，結果維護成本極高。

**解法**：
- 遵循「能用兩個解決就不用三個」原則
- 優先使用串行模式（最簡單）
- 只在必要時才用並行與條件分支

#### 陷阱 3：忽視錯誤處理
**問題**：MCP 調用失敗時，整個流程崩潰。

**解法**：
- 每個 MCP 調用都要有 try-catch
- 設計回退方案（Plan B）
- 記錄詳細的錯誤日誌

#### 陷阱 4：安全意識薄弱
**問題**：API keys 寫在程式碼裡，或上傳到 GitHub。

**解法**：
- 使用環境變數存放敏感資訊
- 配置 `.gitignore` 忽略 `mcp-config.json`
- 定期輪換 API keys
- 遵循權限最小化原則

---

## 🔗 與其他模組的關聯

### 前置模組
- **模組 2**：CLI 工具精通
  - 需要理解 `/agents` 指令
  - 需要掌握基本的工作流程概念

- **模組 2.5**：進階指令整合應用
  - 已經接觸過 MCP 的基本概念
  - 已經學會 Agent 切換的基礎用法

### 後續模組
- **模組 9**：DevOps 與部署自動化
  - MCP 將用於 CI/CD 整合
  - 自動化部署流程將大量使用 MCP

- **模組 10**：安全與合規
  - MCP 的安全配置是重點
  - API keys 管理與審計

---

## 📦 補充資源

### MCP Servers 目錄
- **官方 MCP Servers**：https://github.com/anthropics/anthropic-mcp-servers
- **社群 MCP Servers**：https://github.com/topics/mcp-server
- **自訂 MCP 開發指南**：見 `實作/練習2_自訂MCP開發/`

### 配置範本
- **GitHub MCP**：`範例配置/mcp_templates/github-mcp.json`
- **Database MCP**：`範例配置/mcp_templates/database-mcp.json`
- **Slack + Notion**：`範例配置/mcp_templates/slack-notion-mcp.json`
- **全端開發環境**：`範例配置/mcp_templates/full-stack-dev.json`

### 實戰案例
- **自動化週報系統**：`情境題庫/組合級/C01_自動化週報生成系統.md`
- **知識萃取系統**：`情境題庫/組合級/C02_知識萃取系統.md`
- **DevOps 自動化平台**：`情境題庫/複雜級/E01_企業級DevOps自動化平台.md`

---

## 🎓 教學建議（給講師）

### 教學重點
1. **示範先於理論**：先展示一個完整的自動化流程，讓學員「驚艷」
2. **實作為主**：70% 時間讓學員實作，30% 講解理論
3. **錯誤也是學習**：刻意製造配置錯誤，讓學員學會除錯
4. **安全意識貫穿始終**：每次配置都強調 API keys 管理

### 教學流程建議（1.5 小時）

**第 1 節（30 分鐘）：MCP 驚艷示範**
- 展示自動化週報系統的完整執行（5 分鐘）
- 解釋 MCP 的核心概念（10 分鐘）
- 帶學員配置第一個 GitHub MCP（15 分鐘）

**第 2 節（30 分鐘）：多 MCP 協同**
- 展示 Database + Slack 的協同（5 分鐘）
- 解釋四種編排模式（10 分鐘）
- 帶學員實作 2-MCP 協同（15 分鐘）

**第 3 節（30 分鐘）：完整工作流程**
- 帶學員完成自動化週報系統（25 分鐘）
- 總結與 Q&A（5 分鐘）

### 常見問題預案

**Q1：我沒有 GitHub/Slack/Notion 帳號怎麼辦？**
- 提供測試帳號
- 或使用 File System MCP 作為替代方案

**Q2：MCP 配置一直失敗怎麼辦？**
- 檢查 API keys 是否正確
- 檢查網路連線
- 檢查權限設定
- 查看錯誤日誌

**Q3：自訂 MCP 開發需要什麼技術？**
- 基本的 Python/Node.js 知識
- 理解 HTTP 協議
- 能讀懂 API 文檔

---

## 🏆 學習成就徽章

完成以下檢查點，解鎖對應徽章：

### 🥉 銅牌：MCP 初探者
- [ ] 配置 1 個 MCP server
- [ ] 完成基礎級情境 1 題
- [ ] 理解 MCP 的基本概念

### 🥈 銀牌：工作流程編排師
- [ ] 配置 3+ 個 MCP servers
- [ ] 完成組合級情境 2 題
- [ ] 設計一個 2-MCP 協同的自動化流程

### 🥇 金牌：自動化大師
- [ ] 配置 5+ 個 MCP servers
- [ ] 完成複雜級情境 1 題
- [ ] 開發一個自訂 MCP server
- [ ] 設計 4+ MCP 協同的企業級流程

---

## 📈 預期學習曲線

```
技能熟練度
│
│     ┌─────────────── 金牌：自動化大師
│     │    ┌────────── 銀牌：工作流程編排師
│     │    │    ┌───── 銅牌：MCP 初探者
│     │    │    │
│ 100%│    │    │
│     │    │    │         _____________________
│  80%│    │    │        /
│     │    │    │       /
│  60%│    │    │______/
│     │    │   /|
│  40%│    │__/ │
│     │   /|    │
│  20%│__/ │    │
│     │    │    │
│   0%└────┴────┴────────────────────────────────> 時間
      0h   5h   10h  15h  20h  25h

階段：│理論│基礎配置│多MCP協同│自訂開發│
```

**關鍵里程碑**：
- **5 小時**：完成理論學習 + 配置 3 個 MCP
- **10 小時**：完成 2-MCP 協同自動化流程
- **15 小時**：開始自訂 MCP 開發
- **20+ 小時**：掌握企業級工作流程編排

---

## 🎬 開始你的 MCP 之旅

**推薦起點**：
1. 閱讀 `理論/6.1_MCP協議深入.md`（30 分鐘）
2. 實作 `情境題庫/基礎級/B01_配置GitHub_MCP.md`（45 分鐘）
3. 挑戰 `情境題庫/組合級/C01_自動化週報生成系統.md`（2 小時）

**記住**：
> MCP 不是技術，而是思維方式的轉變。
> 從「我要做什麼」變成「我要自動化什麼」。

讓我們開始吧！🚀

---

**模組維護資訊**：
- **建立日期**：2025-10-30
- **最後更新**：2025-10-30
- **維護者**：AI Programming Course Team
- **版本**：v2.0
