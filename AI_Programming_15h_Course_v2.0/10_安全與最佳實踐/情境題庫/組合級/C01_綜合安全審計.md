# C01: ç¶œåˆå®‰å…¨å¯©è¨ˆ

> **é›£åº¦**: â­â­â­ çµ„åˆç´š
>
> **é è¨ˆè€—æ™‚**: 1.5-2 å°æ™‚
>
> **æ ¸å¿ƒæŠ€èƒ½**: å®Œæ•´å®‰å…¨å¯©è¨ˆæµç¨‹ã€å¤šå·¥å…·æ•´åˆã€åœ˜éšŠå”ä½œèˆ‡å ±å‘Šæ’°å¯«

---

## ğŸ“– æƒ…å¢ƒæè¿°

ä½ å‰›åŠ å…¥ä¸€å®¶æ–°å‰µå…¬å¸æ“”ä»» Senior Developerã€‚ç¬¬ä¸€å¤©ä¸Šç­,CTO æ‰¾ä½ :

> ã€Œæˆ‘å€‘çš„æ ¸å¿ƒç”¢å“æ˜¯ä¸€å€‹ SaaS å¾…è¾¦äº‹é …ç®¡ç†ç³»çµ±,å·²ç¶“æœ‰ 500+ ä»˜è²»ç”¨æˆ¶ã€‚ä¸Šé€±æˆ‘å€‘é–‹å§‹å¤§é‡ä½¿ç”¨ GitHub Copilot åŠ é€Ÿé–‹ç™¼,ä¸€å€‹æœˆå…§äº¤ä»˜äº†å¤§é‡æ–°åŠŸèƒ½ã€‚
>
> ä½†æ˜¯... æˆ‘æœ‰é»æ“”å¿ƒã€‚æˆ‘å€‘åœ˜éšŠéƒ½æ˜¯ Junior Developers,å¯èƒ½å¤ªä¾è³´ AI äº†ã€‚èƒ½ä¸èƒ½è«‹ä½ åšä¸€æ¬¡å…¨é¢çš„å®‰å…¨å¯©è¨ˆ?ç‰¹åˆ¥é—œæ³¨ AI ç”Ÿæˆçš„ä»£ç¢¼ã€‚
>
> æˆ‘å€‘ä¸‹é€±è¦åš Series A èè³‡,æŠ•è³‡äººæœƒè¦æ±‚å®‰å…¨å¯©è¨ˆå ±å‘Šã€‚ã€

---

## å°ˆæ¡ˆæ¦‚æ³

**å°ˆæ¡ˆ**: TaskMaster Pro (å¾…è¾¦äº‹é …ç®¡ç† SaaS)
**æŠ€è¡“æ£§**: Python (Flask), SQLite, JavaScript (React)
**ç”¨æˆ¶æ•¸**: 500+ ä»˜è²»ç”¨æˆ¶
**æ•¸æ“š**: åŒ…å«ç”¨æˆ¶å€‹äººä»»å‹™ã€æ—¥æ›†ã€æª”æ¡ˆä¸Šå‚³

**é—œéµæª”æ¡ˆ** (å·²æä¾›):
```
taskmaster/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app.py              # Flask ä¸»æ‡‰ç”¨
â”‚   â”œâ”€â”€ models.py           # è³‡æ–™åº«æ¨¡å‹
â”‚   â”œâ”€â”€ auth.py             # èªè­‰ç³»çµ± (AI ç”Ÿæˆ)
â”‚   â”œâ”€â”€ api_tasks.py        # ä»»å‹™ API (AI ç”Ÿæˆ)
â”‚   â”œâ”€â”€ file_upload.py      # æª”æ¡ˆä¸Šå‚³ (AI ç”Ÿæˆ)
â”‚   â””â”€â”€ config.py           # é…ç½®æª”æ¡ˆ
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/TaskList.js     # ä»»å‹™åˆ—è¡¨å…ƒä»¶
â”‚   â””â”€â”€ src/api.js          # API å®¢æˆ¶ç«¯
â”œâ”€â”€ .env.example
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

---

## ğŸ¯ ä»»å‹™ç›®æ¨™

### éšæ®µ 1: è‡ªå‹•åŒ–æƒæ (30 åˆ†é˜)
- [ ] è¨­ç½®ä¸¦åŸ·è¡Œ 3 ç¨®ä»¥ä¸Šå®‰å…¨æƒæå·¥å…·
- [ ] æ•´ç†æƒæçµæœ,åˆ†é¡å•é¡Œåš´é‡ç¨‹åº¦
- [ ] è­˜åˆ¥èª¤å ±ä¸¦è¨˜éŒ„

### éšæ®µ 2: æ‰‹å‹•ä»£ç¢¼å¯©æŸ¥ (45 åˆ†é˜)
- [ ] å¯©æŸ¥ AI ç”Ÿæˆçš„ 3 å€‹æ ¸å¿ƒæ¨¡çµ„
- [ ] æª¢æŸ¥ Top 5 å®‰å…¨æ¼æ´ (SQL æ³¨å…¥ã€XSSã€CSRF ç­‰)
- [ ] æª¢æŸ¥æ•æ„Ÿè³‡è¨Šæ´©æ¼ (æ†‘è­‰ã€PII)
- [ ] è¨˜éŒ„æ¯å€‹å•é¡Œçš„ä½ç½®å’Œé¢¨éšªç­‰ç´š

### éšæ®µ 3: åˆè¦æª¢æŸ¥ (15 åˆ†é˜)
- [ ] æª¢æŸ¥æ˜¯å¦æœ‰ç¡¬ç·¨ç¢¼æ†‘è­‰
- [ ] é©—è­‰ .env å’Œ .gitignore é…ç½®
- [ ] æª¢æŸ¥æ—¥èªŒæ˜¯å¦æ´©æ¼ PII
- [ ] è©•ä¼° GDPR åˆè¦æ€§ (ç”¨æˆ¶è³‡æ–™è™•ç†)

### éšæ®µ 4: ä¿®å¾©èˆ‡åŠ å›º (20 åˆ†é˜)
- [ ] ä¿®å¾©è‡³å°‘ 2 å€‹ CRITICAL å•é¡Œ
- [ ] è¨­ç½®è‡ªå‹•åŒ–é˜²è­· (git-secrets, pre-commit)
- [ ] æ›´æ–° README æ·»åŠ å®‰å…¨æœ€ä½³å¯¦è¸

### éšæ®µ 5: å ±å‘Šæ’°å¯« (10 åˆ†é˜)
- [ ] æ’°å¯«çµ¦ CTO çš„åŸ·è¡Œæ‘˜è¦
- [ ] è©³ç´°å•é¡Œåˆ—è¡¨ (åš´é‡ç¨‹åº¦ã€ä½ç½®ã€ä¿®å¾©å»ºè­°)
- [ ] çŸ­æœŸ / é•·æœŸè¡Œå‹•è¨ˆåŠƒ

---

## ğŸ“ æä¾›çš„ä»£ç¢¼ç¯„ä¾‹

### backend/auth.py (AI Generated)

```python
from flask import request, jsonify
import sqlite3
import hashlib
import jwt
import datetime

SECRET_KEY = "super_secret_key_12345"  # TODO: move to config

def hash_password(password):
    return hashlib.md5(password.encode()).hexdigest()

def create_token(user_id, username):
    payload = {
        'user_id': user_id,
        'username': username,
        'exp': datetime.datetime.utcnow() + datetime.timedelta(hours=24)
    }
    return jwt.encode(payload, SECRET_KEY, algorithm='HS256')

def register():
    data = request.get_json()
    username = data.get('username')
    password = data.get('password')
    email = data.get('email')

    conn = sqlite3.connect('taskmaster.db')
    cursor = conn.cursor()

    password_hash = hash_password(password)

    query = f"INSERT INTO users (username, password, email) VALUES ('{username}', '{password_hash}', '{email}')"
    try:
        cursor.execute(query)
        conn.commit()
        return jsonify({"message": "User registered successfully"}), 201
    except:
        return jsonify({"error": "Registration failed"}), 400
    finally:
        conn.close()

def login():
    data = request.get_json()
    username = data.get('username')
    password = data.get('password')

    conn = sqlite3.connect('taskmaster.db')
    cursor = conn.cursor()

    password_hash = hash_password(password)
    query = f"SELECT * FROM users WHERE username = '{username}' AND password = '{password_hash}'"

    cursor.execute(query)
    user = cursor.fetchone()
    conn.close()

    if user:
        token = create_token(user[0], user[1])
        return jsonify({"token": token, "username": user[1]}), 200

    return jsonify({"error": "Invalid credentials"}), 401
```

### backend/file_upload.py (AI Generated)

```python
from flask import request, send_file
import os

UPLOAD_FOLDER = '/var/www/uploads'

def upload_file():
    if 'file' not in request.files:
        return {"error": "No file provided"}, 400

    file = request.files['file']
    filename = request.form.get('filename', file.filename)

    # Save file
    filepath = os.path.join(UPLOAD_FOLDER, filename)
    file.save(filepath)

    return {"message": "File uploaded", "path": filepath}, 200

def download_file():
    filename = request.args.get('file')
    filepath = f"{UPLOAD_FOLDER}/{filename}"

    if os.path.exists(filepath):
        return send_file(filepath)
    return {"error": "File not found"}, 404

def list_user_files():
    user_id = request.args.get('user_id')
    query = f"SELECT * FROM files WHERE user_id = {user_id}"

    conn = sqlite3.connect('taskmaster.db')
    cursor = conn.cursor()
    cursor.execute(query)
    files = cursor.fetchall()
    conn.close()

    return {"files": files}, 200
```

### backend/api_tasks.py (AI Generated)

```python
from flask import request, jsonify
import sqlite3

def get_tasks():
    user_id = request.args.get('user_id')
    search = request.args.get('search', '')

    conn = sqlite3.connect('taskmaster.db')
    cursor = conn.cursor()

    if search:
        query = f"SELECT * FROM tasks WHERE user_id = {user_id} AND title LIKE '%{search}%'"
    else:
        query = f"SELECT * FROM tasks WHERE user_id = {user_id}"

    cursor.execute(query)
    tasks = cursor.fetchall()
    conn.close()

    return jsonify({"tasks": tasks}), 200

def create_task():
    data = request.get_json()
    user_id = data.get('user_id')
    title = data.get('title')
    description = data.get('description')

    conn = sqlite3.connect('taskmaster.db')
    cursor = conn.cursor()

    query = f"INSERT INTO tasks (user_id, title, description) VALUES ({user_id}, '{title}', '{description}')"
    cursor.execute(query)
    conn.commit()
    conn.close()

    return jsonify({"message": "Task created"}), 201

def delete_task():
    task_id = request.args.get('id')

    conn = sqlite3.connect('taskmaster.db')
    cursor = conn.cursor()

    query = f"DELETE FROM tasks WHERE id = {task_id}"
    cursor.execute(query)
    conn.commit()
    conn.close()

    return jsonify({"message": "Task deleted"}), 200
```

---

## ğŸ” å¯©è¨ˆæª¢æŸ¥æ¸…å–®

### Critical Issues æª¢æŸ¥

- [ ] **SQL Injection**: æª¢æŸ¥æ‰€æœ‰ SQL æŸ¥è©¢
- [ ] **Hardcoded Secrets**: æœå°‹æ†‘è­‰ã€API keys
- [ ] **Path Traversal**: æª¢æŸ¥æª”æ¡ˆæ“ä½œ
- [ ] **Weak Crypto**: æª¢æŸ¥å¯†ç¢¼é›œæ¹Šæ–¹å¼
- [ ] **Authentication**: JWT å¯¦ä½œæ˜¯å¦å®‰å…¨

### High Priority æª¢æŸ¥

- [ ] **Input Validation**: ç”¨æˆ¶è¼¸å…¥æ˜¯å¦é©—è­‰
- [ ] **CSRF Protection**: æ˜¯å¦æœ‰ CSRF token
- [ ] **XSS**: å‰ç«¯æ˜¯å¦æ­£ç¢º escape è¼¸å‡º
- [ ] **Authorization**: æ˜¯å¦æœ‰æ¬Šé™æª¢æŸ¥
- [ ] **Rate Limiting**: æ˜¯å¦æœ‰é˜²æš´åŠ›ç ´è§£

### Compliance æª¢æŸ¥

- [ ] **GDPR**: ç”¨æˆ¶è³‡æ–™æ˜¯å¦å¯åˆªé™¤
- [ ] **.env**: æ•æ„Ÿè³‡è¨Šæ˜¯å¦åœ¨ç’°å¢ƒè®Šæ•¸
- [ ] **.gitignore**: æ˜¯å¦åŒ…å« .env, *.db
- [ ] **Logging**: æ—¥èªŒæ˜¯å¦æ´©æ¼ PII
- [ ] **Dependencies**: ä¾è³´æ˜¯å¦æœ‰å·²çŸ¥æ¼æ´

---

## âœ… åƒè€ƒè§£ç­” (ç²¾ç°¡ç‰ˆ)

### ç™¼ç¾çš„å•é¡Œæ‘˜è¦

#### CRITICAL (å¿…é ˆç«‹å³ä¿®å¾©)

1. **SQL Injection** - 10+ è™•
   - ä½ç½®: auth.py (register, login), file_upload.py (list_user_files), api_tasks.py (æ‰€æœ‰å‡½æ•¸)
   - é¢¨éšª: å®Œæ•´è³‡æ–™åº«æ§åˆ¶
   - ä¿®å¾©: ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢

2. **ç¡¬ç·¨ç¢¼ JWT Secret**
   - ä½ç½®: auth.py line 6
   - é¢¨éšª: æ”»æ“Šè€…å¯å½é€  token
   - ä¿®å¾©: ä½¿ç”¨ç’°å¢ƒè®Šæ•¸

3. **å¼±å¯†ç¢¼é›œæ¹Š (MD5)**
   - ä½ç½®: auth.py line 8
   - é¢¨éšª: å¯†ç¢¼å¯è¢«ç ´è§£
   - ä¿®å¾©: ä½¿ç”¨ bcrypt

4. **è·¯å¾‘éæ­·**
   - ä½ç½®: file_upload.py line 13, 19
   - é¢¨éšª: è®€å–/å¯«å…¥ä»»æ„æª”æ¡ˆ
   - ä¿®å¾©: è·¯å¾‘é©—è­‰

#### HIGH

5. **ç¼ºå°‘æ¬Šé™æª¢æŸ¥**
   - delete_task æ²’æª¢æŸ¥ä»»å‹™æ˜¯å¦å±¬æ–¼è©²ç”¨æˆ¶
   - ä»»ä½•äººå¯åˆªé™¤ä»»ä½•ä»»å‹™

6. **JWT æ²’é©—è­‰**
   - API ç«¯é»æ²’é©—è­‰ JWT token

---

### è‡ªå‹•åŒ–æƒæå‘½ä»¤

```bash
# 1. Bandit (Python)
bandit -r backend/ -f json -o bandit-report.json

# 2. Safety (ä¾è³´æ¼æ´)
safety check --file requirements.txt

# 3. Semgrep (å®‰å…¨æ¨¡å¼)
semgrep --config "p/security-audit" backend/

# 4. Git secrets (æª¢æŸ¥æ­·å²)
git secrets --scan-history

# 5. TruffleHog (æ·±åº¦æƒæ)
trufflehog git file://. --only-verified
```

---

### å®‰å…¨å¯©è¨ˆå ±å‘Šæ¨¡æ¿

```markdown
# TaskMaster Pro å®‰å…¨å¯©è¨ˆå ±å‘Š

## åŸ·è¡Œæ‘˜è¦

**å¯©è¨ˆæ—¥æœŸ**: 2024-XX-XX
**å¯©è¨ˆç¯„åœ**: Backend API (Python/Flask)
**åš´é‡ç¨‹åº¦**: ğŸ”´ CRITICAL

### é—œéµç™¼ç¾
- âŒ ç™¼ç¾ **10+ Critical** å®‰å…¨æ¼æ´
- âŒ æ‰€æœ‰ AI ç”Ÿæˆçš„ä»£ç¢¼æ¨¡çµ„éƒ½å­˜åœ¨ SQL æ³¨å…¥
- âŒ ç¡¬ç·¨ç¢¼æ†‘è­‰ã€å¼±åŠ å¯†ã€ç¼ºå°‘æ¬Šé™æª¢æŸ¥
- âš ï¸ **ä¸å»ºè­°åœ¨ç•¶å‰ç‹€æ…‹ä¸‹é€²è¡Œèè³‡æ¼”ç¤º**

### å»ºè­°
1. **ç«‹å³**: ä¿®å¾©æ‰€æœ‰ CRITICAL å•é¡Œ (é è¨ˆ 1-2 å¤©)
2. **æœ¬é€±**: è¨­ç½®è‡ªå‹•åŒ–å®‰å…¨æƒæ CI/CD
3. **æœ¬æœˆ**: é€²è¡Œæ»²é€æ¸¬è©¦

---

## è©³ç´°å•é¡Œåˆ—è¡¨

### C1: SQL Injection (CRITICAL)

**å½±éŸ¿**: æ”»æ“Šè€…å¯å®Œå…¨æ§åˆ¶è³‡æ–™åº«,ç«Šå–æ‰€æœ‰ç”¨æˆ¶è³‡æ–™

**ä½ç½®**:
- `auth.py:27` - register å‡½æ•¸
- `auth.py:41` - login å‡½æ•¸
- `file_upload.py:24` - list_user_files å‡½æ•¸
- `api_tasks.py:9,11,23,35` - æ‰€æœ‰ä»»å‹™ API

**æ”»æ“Šç¤ºç¯„**:
```python
# ç¹éç™»å…¥
POST /login {"username": "admin' OR '1'='1", "password": "anything"}

# åˆªé™¤æ‰€æœ‰ä»»å‹™
DELETE /tasks?id=1 OR 1=1
```

**ä¿®å¾©æ–¹æ¡ˆ**:
```python
# âŒ éŒ¯èª¤
query = f"SELECT * FROM users WHERE username = '{username}'"

# âœ… æ­£ç¢º
cursor.execute("SELECT * FROM users WHERE username = ?", (username,))
```

**å„ªå…ˆç´š**: P0 (ç«‹å³ä¿®å¾©)
**é è¨ˆä¿®å¾©æ™‚é–“**: 4 å°æ™‚

---

### C2: ç¡¬ç·¨ç¢¼ JWT Secret (CRITICAL)

**å½±éŸ¿**: æ”»æ“Šè€…å¯å½é€ ä»»æ„ç”¨æˆ¶çš„ JWT token

**ä½ç½®**: `auth.py:6`

**ä¿®å¾©æ–¹æ¡ˆ**:
```python
# .env
JWT_SECRET_KEY=<éš¨æ©Ÿç”Ÿæˆçš„ 256-bit key>

# auth.py
import os
SECRET_KEY = os.getenv('JWT_SECRET_KEY')
if not SECRET_KEY:
    raise ValueError("JWT_SECRET_KEY not set")
```

**å„ªå…ˆç´š**: P0
**é è¨ˆä¿®å¾©æ™‚é–“**: 30 åˆ†é˜

---

(... çœç•¥å…¶ä»–å•é¡Œè©³ç´°æè¿° ...)

---

## è¡Œå‹•è¨ˆåŠƒ

### ç«‹å³è¡Œå‹• (æœ¬é€±)
- [ ] ä¿®å¾©æ‰€æœ‰ CRITICAL å•é¡Œ
- [ ] è¨­ç½® git-secrets å’Œ pre-commit
- [ ] æ·»åŠ å–®å…ƒæ¸¬è©¦è¦†è“‹å®‰å…¨ä¿®å¾©

### çŸ­æœŸ (2 é€±å…§)
- [ ] åœ¨ CI/CD ä¸­é›†æˆ bandit + semgrep
- [ ] ä»£ç¢¼å¯©æŸ¥æµç¨‹åŠ å…¥å®‰å…¨æª¢æŸ¥æ¸…å–®
- [ ] åœ˜éšŠå®‰å…¨åŸ¹è¨“

### ä¸­æœŸ (1 æœˆå…§)
- [ ] ç¬¬ä¸‰æ–¹æ»²é€æ¸¬è©¦
- [ ] å¯¦ä½œ WAF (Web Application Firewall)
- [ ] å»ºç«‹å®‰å…¨äº‹ä»¶éŸ¿æ‡‰æµç¨‹

---

## ç¸½çµ

TaskMaster Pro ç•¶å‰å­˜åœ¨å¤šå€‹åš´é‡å®‰å…¨æ¼æ´,ä¸»è¦æºæ–¼:
1. éåº¦ä¾è³´ AI ç”Ÿæˆä»£ç¢¼,ç¼ºå°‘å®‰å…¨å¯©æŸ¥
2. åœ˜éšŠå®‰å…¨æ„è­˜ä¸è¶³
3. ç¼ºä¹è‡ªå‹•åŒ–å®‰å…¨æƒæ

**å»ºè­°**: åœ¨ä¿®å¾© CRITICAL å•é¡Œå‰,æš«ç·©èè³‡æ¼”ç¤ºã€‚
é è¨ˆä¿®å¾©æ™‚é–“: 2-3 å€‹å·¥ä½œæ—¥ã€‚
```

---

## ğŸ“ å­¸ç¿’æª¢æŸ¥æ¸…å–®

å®Œæˆæ­¤æƒ…å¢ƒå¾Œ,ä½ æ‡‰è©²èƒ½å¤ :

- [ ] ç¨ç«‹åŸ·è¡Œå®Œæ•´çš„å®‰å…¨å¯©è¨ˆæµç¨‹
- [ ] ä½¿ç”¨ 3+ ç¨®è‡ªå‹•åŒ–å®‰å…¨æƒæå·¥å…·
- [ ] æ’°å¯«å°ˆæ¥­çš„å®‰å…¨å¯©è¨ˆå ±å‘Š
- [ ] è©•ä¼° AI ç”Ÿæˆä»£ç¢¼çš„å®‰å…¨é¢¨éšª
- [ ] åˆ¶å®šå¯åŸ·è¡Œçš„å®‰å…¨æ”¹é€²è¨ˆåŠƒ

---

## ğŸ¯ å»¶ä¼¸æŒ‘æˆ°

1. **å¯¦éš›ä¿®å¾©**: é‡å¯« auth.py,ä¿®å¾©æ‰€æœ‰å®‰å…¨å•é¡Œ
2. **CI/CD æ•´åˆ**: è¨­ç½® GitHub Actions è‡ªå‹•å®‰å…¨æƒæ
3. **åœ˜éšŠåˆ†äº«**: å‘åœ˜éšŠæ¼”ç¤ºå®‰å…¨å¯©è¨ˆæµç¨‹
4. **æ·±å…¥å­¸ç¿’**: ç ”ç©¶ OWASP Top 10 ä¸¦å»ºç«‹æª¢æŸ¥æ¸…å–®

---

**å®Œæˆé€™å€‹æƒ…å¢ƒ,ä½ å°±å…·å‚™äº†é€²è¡Œå°ˆæ¥­å®‰å…¨å¯©è¨ˆçš„èƒ½åŠ›!**
