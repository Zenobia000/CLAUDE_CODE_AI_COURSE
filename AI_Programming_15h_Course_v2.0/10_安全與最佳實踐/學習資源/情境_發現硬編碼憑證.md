# æƒ…å¢ƒï¼šç™¼ç¾ç¡¬ç·¨ç¢¼æ†‘è­‰

> **å­¸ç¿’ç›®æ¨™**: é€éçœŸå¯¦å ´æ™¯å­¸ç¿’å¦‚ä½•è­˜åˆ¥ã€ä¿®å¾©ä¸¦é é˜²ç¡¬ç·¨ç¢¼æ†‘è­‰å•é¡Œ

---

## æƒ…å¢ƒèƒŒæ™¯

ä½ æ­£åœ¨ä½¿ç”¨ Claude Code é–‹ç™¼ä¸€å€‹æ–°åŠŸèƒ½ï¼Œéœ€è¦æ•´åˆ OpenAI APIã€‚ä½ å‘ Claude è©¢å•ï¼š

**ä½ çš„æå•**:
> "å¹«æˆ‘å¯«ä¸€å€‹ Python å‡½æ•¸ï¼Œä½¿ç”¨ OpenAI API ç”Ÿæˆæ–‡æœ¬æ‘˜è¦"

**Claude å›è¦†çš„ä»£ç¢¼**:
```python
import openai

def generate_summary(text):
    openai.api_key = "sk-proj-abc123def456789..."  # ä½ çš„ API key

    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[
            {"role": "system", "content": "ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„æ‘˜è¦åŠ©æ‰‹"},
            {"role": "user", "content": f"è«‹ç¸½çµä»¥ä¸‹å…§å®¹ï¼š\n{text}"}
        ]
    )

    return response.choices[0].message.content
```

ä½ è¦ºå¾—é€™æ®µä»£ç¢¼çœ‹èµ·ä¾†å¾ˆåˆç†ï¼Œæº–å‚™ç›´æ¥ä½¿ç”¨...

---

## ğŸš¨ å•é¡Œè­˜åˆ¥

### ç¬¬ä¸€æ­¥ï¼šç™¼ç¾å•é¡Œ

**æª¢æŸ¥æ¸…å–®**:
- [ ] ä»£ç¢¼ä¸­æœ‰ `api_key =` è³¦å€¼å—ï¼Ÿ
- [ ] å€¼æ˜¯å­—ä¸²å­—é¢é‡ (ç”¨å¼•è™ŸåŒ…åœ) å—ï¼Ÿ
- [ ] é€™å€‹å€¼æœƒè¢« commit åˆ° Git å—ï¼Ÿ

**å±éšªä¿¡è™Ÿ**:
```python
openai.api_key = "sk-proj-abc123def456789..."  # âš ï¸ ç¡¬ç·¨ç¢¼ï¼
```

**ç‚ºä»€éº¼é€™æ˜¯å•é¡Œï¼Ÿ**
1. ä¸€æ—¦ commitï¼Œå³ä½¿å¾ŒçºŒåˆªé™¤ï¼Œä»å¯å¾ Git æ­·å²ä¸­æ‰¾åˆ°
2. å¦‚æœæ¨é€åˆ° GitHubï¼Œæƒææ©Ÿå™¨äººæœƒåœ¨å¹¾åˆ†é˜å…§ç™¼ç¾
3. æ”»æ“Šè€…å¯ä»¥ä½¿ç”¨ä½ çš„ API keyï¼Œå°è‡´å¸³å–®çˆ†å¢

---

### ç¬¬äºŒæ­¥ï¼šè©•ä¼°é¢¨éšª

**é¢¨éšªç­‰ç´š**: ğŸ”´ æ¥µé«˜

**å¯èƒ½å¾Œæœ**:
- OpenAI å¸³è™Ÿè¢«ç›œç”¨ï¼Œç”¢ç”Ÿå¤§é‡ API è²»ç”¨
- æ•æ„Ÿæ•¸æ“šè¢«å¤–æ´© (å¦‚æœ key æœ‰æ¬Šé™è¨ªå•)
- éœ€è¦ç·Šæ€¥æ’¤éŠ·ä¸¦é‡æ–°ç”Ÿæˆ API key
- å¯èƒ½é•åå…¬å¸å®‰å…¨æ”¿ç­–

---

## ğŸ”§ ä¿®å¾©æ–¹æ¡ˆ

### æ–¹æ¡ˆ #1: ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ (æ¨è–¦)

```python
# âœ… å®‰å…¨åšæ³•
import os
import openai
from dotenv import load_dotenv

# è¼‰å…¥ç’°å¢ƒè®Šæ•¸
load_dotenv()

def generate_summary(text):
    # å¾ç’°å¢ƒè®Šæ•¸è®€å–
    api_key = os.getenv('OPENAI_API_KEY')

    # é©—è­‰ key æ˜¯å¦å­˜åœ¨
    if not api_key:
        raise ValueError("OPENAI_API_KEY not found in environment")

    openai.api_key = api_key

    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[
            {"role": "system", "content": "ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„æ‘˜è¦åŠ©æ‰‹"},
            {"role": "user", "content": f"è«‹ç¸½çµä»¥ä¸‹å…§å®¹ï¼š\n{text}"}
        ]
    )

    return response.choices[0].message.content
```

**é…å¥—æ­¥é©Ÿ**:

```bash
# 1. å‰µå»º .env æª”æ¡ˆ
echo "OPENAI_API_KEY=sk-proj-your-actual-key-here" > .env

# 2. ç¢ºä¿ .env åœ¨ .gitignore ä¸­
echo ".env" >> .gitignore

# 3. æä¾› .env.example ä½œç‚ºç¯„æœ¬
echo "OPENAI_API_KEY=your-openai-api-key-here" > .env.example

# 4. å®‰è£ä¾è³´
pip install python-dotenv
```

---

### æ–¹æ¡ˆ #2: ä½¿ç”¨é…ç½®æª”æ¡ˆ

```python
# config.py
import os
from pathlib import Path

class Config:
    OPENAI_API_KEY = os.getenv('OPENAI_API_KEY')

    @classmethod
    def validate(cls):
        if not cls.OPENAI_API_KEY:
            raise ValueError("Missing OPENAI_API_KEY")

# main.py
from config import Config
import openai

Config.validate()  # å•Ÿå‹•æ™‚é©—è­‰

def generate_summary(text):
    openai.api_key = Config.OPENAI_API_KEY
    # ... å…¶é¤˜ä»£ç¢¼
```

---

## ğŸ›¡ï¸ é é˜²æªæ–½

### é˜²ç·š #1: è¨­ç½® git-secrets

```bash
# å®‰è£ git-secrets
brew install git-secrets  # macOS
# æˆ–åƒè€ƒ https://github.com/awslabs/git-secrets

# åœ¨å°ˆæ¡ˆä¸­å•Ÿç”¨
git secrets --install

# æ·»åŠ  OpenAI key æ¨¡å¼
git secrets --add 'sk-[a-zA-Z0-9]{32,}'
```

**æ¸¬è©¦é˜²ç·š**:
```bash
# å˜—è©¦ commit åŒ…å« API key çš„æ–‡ä»¶
echo 'api_key = "sk-proj-abc123..."' > test.py
git add test.py
git commit -m "test"

# æ‡‰è©²è¢«é˜»æ­¢:
# [ERROR] Matched one or more prohibited patterns
```

---

### é˜²ç·š #2: ä½¿ç”¨ pre-commit hooks

```yaml
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.4.0
    hooks:
      - id: detect-secrets
        args: ['--baseline', '.secrets.baseline']
```

```bash
# å®‰è£
pip install pre-commit detect-secrets
pre-commit install
detect-secrets scan > .secrets.baseline
```

---

### é˜²ç·š #3: IDE æç¤º (å¯é¸)

**VS Code æ“´å±•**: [GitGuardian](https://marketplace.visualstudio.com/items?itemName=GitGuardian.gitguardian)

å®‰è£å¾Œæœƒå³æ™‚æç¤ºç¡¬ç·¨ç¢¼æ†‘è­‰ã€‚

---

## ğŸ“š è‡ªç„¶å­¸åˆ°çš„æŒ‡ä»¤èˆ‡å·¥å…·

é€éé€™å€‹æƒ…å¢ƒï¼Œä½ è‡ªç„¶å­¸æœƒäº†ï¼š

### æŒ‡ä»¤
```bash
# Git ç›¸é—œ
git secrets --install         # å®‰è£ git-secrets hooks
git secrets --add <pattern>   # æ·»åŠ æª¢æ¸¬æ¨¡å¼
git secrets --scan            # æƒæç•¶å‰æ–‡ä»¶

# ç’°å¢ƒè®Šæ•¸
echo "VAR=value" > .env       # å‰µå»ºç’°å¢ƒè®Šæ•¸æª”æ¡ˆ
echo ".env" >> .gitignore     # æ·»åŠ åˆ° gitignore

# Pre-commit
pre-commit install            # å®‰è£ hooks
pre-commit run --all-files    # åŸ·è¡Œæ‰€æœ‰æª¢æŸ¥
```

### Python å·¥å…·
```python
# ç’°å¢ƒè®Šæ•¸è®€å–
import os
os.getenv('KEY_NAME')
os.getenv('KEY_NAME', 'default_value')

# .env æª”æ¡ˆæ”¯æ´
from dotenv import load_dotenv
load_dotenv()
```

---

## ğŸ¯ æƒ…å¢ƒå»¶ä¼¸

### æŒ‘æˆ° #1: å·²ç¶“ commit äº†æ€éº¼è¾¦ï¼Ÿ

**æƒ…å¢ƒ**: ä½ å·²ç¶“ commit ä¸¦æ¨é€äº†åŒ…å« API key çš„ä»£ç¢¼

**æ‡‰æ€¥è™•ç†**:
```bash
# 1. ç«‹å³æ’¤éŠ· API key (OpenAI Dashboard)
# è¨ªå• https://platform.openai.com/api-keys
# é»æ“Š "Revoke" æ’¤éŠ·æ´©æ¼çš„ key

# 2. ç”Ÿæˆæ–°çš„ API key

# 3. å¾ Git æ­·å²ä¸­ç§»é™¤æ•æ„Ÿè³‡è¨Š
git filter-branch --force --index-filter \
  "git rm --cached --ignore-unmatch path/to/file.py" \
  --prune-empty --tag-name-filter cat -- --all

# 4. å¼·åˆ¶æ¨é€ (è¬¹æ…!)
git push origin --force --all

# 5. é€šçŸ¥åœ˜éšŠæˆå“¡åˆªé™¤æœ¬åœ°èˆŠæ­·å²
git fetch origin
git reset --hard origin/main
```

---

### æŒ‘æˆ° #2: å¦‚ä½•æƒææ­·å² commitsï¼Ÿ

```bash
# ä½¿ç”¨ TruffleHog æƒææ•´å€‹ Git æ­·å²
pip install trufflehog
trufflehog git file://. --only-verified

# ä½¿ç”¨ git-secrets æƒææ­·å²
git secrets --scan-history
```

---

## âœ… å­¸ç¿’é©—è­‰

å®Œæˆæ­¤æƒ…å¢ƒå¾Œï¼Œä½ æ‡‰è©²èƒ½å¤ ï¼š

- [ ] åœ¨ 5 ç§’å…§è­˜åˆ¥ç¡¬ç·¨ç¢¼æ†‘è­‰
- [ ] ä½¿ç”¨ç’°å¢ƒè®Šæ•¸é‡æ§‹ä»£ç¢¼
- [ ] è¨­ç½® git-secrets é˜²æ­¢æœªä¾†æ´©æ¼
- [ ] çŸ¥é“æ†‘è­‰æ´©æ¼å¾Œçš„æ‡‰æ€¥è™•ç†æ­¥é©Ÿ

---

## ğŸ”— å»¶ä¼¸å­¸ç¿’

- **ç†è«–**: `ç†è«–/10.1_AIç”Ÿæˆä»£ç¢¼å®‰å…¨é¢¨éšª.md` - æ·±å…¥äº†è§£ç¡¬ç·¨ç¢¼æ†‘è­‰çš„é¢¨éšª
- **å¯¦ä½œ**: `æƒ…å¢ƒé¡Œåº«/åŸºç¤ç´š/B01_APIé‡‘é‘°æ´©æ¼æ‡‰å°.md` - å®Œæ•´æ¼”ç·´æ´©æ¼æ‡‰å°æµç¨‹
- **å·¥å…·**: `å­¸ç¿’è³‡æº/å·¥å…·æ•´åˆå¯¦æˆ°.md` - æ·±å…¥å­¸ç¿’è‡ªå‹•åŒ–å·¥å…·è¨­ç½®

---

**è¨˜ä½**ï¼š

> **ã€Œæ†‘è­‰å°±åƒå®¶è£¡çš„é‘°åŒ™ â€” ä½ ä¸æœƒæŠŠå®ƒåˆ»åœ¨é–€ä¸Šã€**

å¾ä»Šå¤©é–‹å§‹ï¼Œæ¯æ¬¡çœ‹åˆ° `api_key = "`ï¼Œç«‹åˆ»æ›¿æ›ç‚º `os.getenv()`ã€‚
