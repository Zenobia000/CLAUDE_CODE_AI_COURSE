# 記憶卡庫 - 安全與最佳實踐

> **學習目標**: 透過間隔重複記憶法(Spaced Repetition)，強化安全意識與應急反應能力

---

## 📚 閃卡概述

本卡庫包含 **10 張情境式 Anki 閃卡**，聚焦於：
- 🚨 風險識別 (5 張)
- 🛡️ 預防措施 (3 張)
- ⚡ 應急反應 (2 張)

---

## 🎴 閃卡清單

### 風險識別類 (5 張)

1. **辨識硬編碼憑證**
   - 正面：這段代碼有什麼安全風險？`api_key = "sk-proj-abc123..."`
   - 背面：硬編碼憑證，應使用 `os.getenv('API_KEY')`

2. **辨識 SQL 注入**
   - 正面：這段代碼有什麼安全風險？`query = f"SELECT * FROM users WHERE name = '{user_input}'"`
   - 背面：SQL 注入風險，應使用參數化查詢 `cursor.execute("SELECT * FROM users WHERE name = ?", (user_input,))`

3. **辨識路徑遍歷**
   - 正面：用戶訪問 `/download/../../etc/passwd` 會發生什麼？
   - 背面：路徑遍歷攻擊，可能讀取系統敏感文件。應使用 `pathlib.resolve()` 和 `.relative_to()` 驗證路徑

4. **辨識不安全反序列化**
   - 正面：為什麼 `pickle.loads(user_input)` 危險？
   - 背面：可執行任意代碼（RCE），應使用 `json.loads()` 或 `pydantic`

5. **辨識過度權限**
   - 正面：`chmod 777 config.json` 有什麼問題？
   - 背面：所有用戶可讀寫執行，應使用 `chmod 600`（只有擁有者可讀寫）

---

### 預防措施類 (3 張)

6. **git-secrets 設置**
   - 正面：如何設置 git-secrets 防止憑證洩漏？
   - 背面：`git secrets --install && git secrets --register-aws`

7. **參數化查詢**
   - 正面：如何安全地執行包含用戶輸入的 SQL 查詢？
   - 背面：使用參數化查詢：`cursor.execute("SELECT * FROM users WHERE id = ?", (user_id,))`

8. **環境變數管理**
   - 正面：如何安全地存儲 API keys？
   - 背面：使用 `.env` 文件 + `python-dotenv`，並確保 `.env` 在 `.gitignore` 中

---

### 應急反應類 (2 張)

9. **API key 洩漏應急**
   - 正面：發現 API key 已 commit 到 GitHub，最緊急的 3 個步驟是？
   - 背面：
     1. 立即撤銷 key (< 3 分鐘)
     2. 生成新 key 並更新配置 (< 5 分鐘)
     3. 從 Git 歷史移除 (使用 BFG 或 git filter-branch)

10. **安全審查口訣**
    - 正面：接受 AI 生成代碼前必問的 5 個問題？
    - 背面：「密碼路序權」
      - 密：硬編碼憑證？
      - 碼：SQL 注入？
      - 路：路徑遍歷？
      - 序：不安全反序列化？
      - 權：過度權限？

---

## 📥 導入 Anki

### 方法 1: 手動創建卡片

1. 下載 Anki: https://apps.ankiweb.net/
2. 創建新卡組：「安全與最佳實踐」
3. 根據上述清單手動創建卡片

---

### 方法 2: 匯入 CSV (推薦)

**步驟**:

1. 使用提供的 `anki_cards.csv` 文件
2. 在 Anki 中選擇「檔案」→「匯入」
3. 選擇 `anki_cards.csv`
4. 設定：
   - 欄位 1 → Front (正面)
   - 欄位 2 → Back (背面)
   - 欄位分隔符號：逗號

---

## 🎯 學習建議

### 學習節奏

- **第 1 週**: 每天複習所有 10 張卡片
- **第 2-4 週**: 依照 Anki 的間隔重複演算法複習
- **第 5 週起**: 只複習 Anki 提示的到期卡片

### 成效驗證

完成 4 週複習後，你應該能夠：
- [ ] 在 5 秒內識別硬編碼憑證
- [ ] 立即區分安全與不安全的 SQL 查詢
- [ ] 背誦應急處理的 3 個關鍵步驟
- [ ] 不查資料就能設置基本安全工具

---

## 🔗 搭配學習資源

- **理論**: `理論/10.1_AI生成代碼安全風險.md`
- **實作**: `情境題庫/` 完成實戰演練
- **工具**: `學習資源/工具整合實戰.md`

---

**記住**：

> **「重複是記憶之母，情境是理解之父」**

每天 5 分鐘的閃卡複習，勝過臨時抱佛腳。
