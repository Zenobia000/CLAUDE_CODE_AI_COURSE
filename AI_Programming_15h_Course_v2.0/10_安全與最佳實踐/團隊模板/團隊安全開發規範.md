# åœ˜éšŠå®‰å…¨é–‹ç™¼è¦ç¯„

> **é©ç”¨å°è±¡**: æ‰€æœ‰ä½¿ç”¨ AI è¼”åŠ©é–‹ç™¼å·¥å…·çš„åœ˜éšŠæˆå“¡
> **æœ€å¾Œæ›´æ–°**: YYYY-MM-DD
> **ç¶­è­·è€…**: [Tech Lead Name]

---

## ğŸ“‹ æ ¸å¿ƒåŸå‰‡

### 1. é©—è­‰å„ªæ–¼ä¿¡ä»» (Verify over Trust)

> **ã€Œæ°¸é ä¸è¦ç›´æ¥è¤‡è£½ AI ç”Ÿæˆçš„ä»£ç¢¼è€Œä¸å¯©æŸ¥ã€**

- âœ… æ‰€æœ‰ AI ç”Ÿæˆçš„ä»£ç¢¼å¿…é ˆç¶“éå®‰å…¨å¯©æŸ¥
- âœ… ä½¿ç”¨è‡ªå‹•åŒ–å·¥å…·é©—è­‰ï¼ˆgit-secrets, Semgrepï¼‰
- âŒ ä¸å¯å› ç‚ºã€ŒAI å¾ˆè°æ˜ã€å°±è·³éæª¢æŸ¥

---

### 2. æœ€å°æ¬Šé™åŸå‰‡ (Principle of Least Privilege)

- âœ… é…ç½®æ–‡ä»¶æ¬Šé™ `chmod 600`
- âœ… æ‡‰ç”¨ä¸ä½¿ç”¨ root é‹è¡Œ
- âœ… è³‡æ–™åº«ä½¿ç”¨å°ˆç”¨å¸³è™Ÿï¼Œåªæˆäºˆå¿…è¦æ¬Šé™
- âŒ ç¦æ­¢ `chmod 777`ã€`sudo python app.py`

---

### 3. æ·±åº¦é˜²ç¦¦ (Defense in Depth)

- âœ… å¤šå±¤å®‰å…¨æª¢æŸ¥ï¼špre-commit + CI/CD + Code Review
- âœ… è‡ªå‹•åŒ–å·¥å…· + äººå·¥å¯©æŸ¥
- âœ… é–‹ç™¼ç’°å¢ƒ + æ¸¬è©¦ç’°å¢ƒ + ç”Ÿç”¢ç’°å¢ƒåˆ†é›¢

---

## ğŸ”’ æ†‘è­‰ç®¡ç†è¦ç¯„

### ç¦æ­¢äº‹é … âŒ

```python
# âŒ çµ•å°ç¦æ­¢
password = "admin123"
API_KEY = "sk-proj-..."
db_url = "postgresql://user:pass@host/db"
SECRET_KEY = "my-secret"
```

### å¿…é ˆåšæ³• âœ…

```python
# âœ… æ­£ç¢ºåšæ³•
import os
from dotenv import load_dotenv

load_dotenv()
password = os.getenv('DB_PASSWORD')
API_KEY = os.getenv('OPENAI_API_KEY')
db_url = os.getenv('DATABASE_URL')
SECRET_KEY = os.getenv('SECRET_KEY')
```

### å­˜å„²è¦ç¯„

1. **é–‹ç™¼ç’°å¢ƒ**: ä½¿ç”¨ `.env` æ–‡ä»¶ï¼ˆç¢ºä¿åœ¨ `.gitignore` ä¸­ï¼‰
2. **ç”Ÿç”¢ç’°å¢ƒ**: ä½¿ç”¨ç’°å¢ƒè®Šæ•¸æˆ–å¯†é‘°ç®¡ç†æœå‹™
   - AWS: AWS Secrets Manager / Parameter Store
   - Azure: Azure Key Vault
   - GCP: Secret Manager
   - Self-hosted: HashiCorp Vault

---

## ğŸ›¡ï¸ ä»£ç¢¼å®‰å…¨æª¢æŸ¥æ¸…å–®

### Commit å‰æª¢æŸ¥ (æ¯æ¬¡å¿…åš)

```
[ ] 1. ç¡¬ç·¨ç¢¼æ†‘è­‰ï¼Ÿ
    æœå°‹: password =, api_key =, secret =

[ ] 2. SQL æ³¨å…¥é¢¨éšªï¼Ÿ
    æœå°‹: f"SELECT, execute("... " +

[ ] 3. è·¯å¾‘éæ­·é¢¨éšªï¼Ÿ
    æœå°‹: open(user_input), f"/path/{user_input}"

[ ] 4. ä¸å®‰å…¨ååºåˆ—åŒ–ï¼Ÿ
    æœå°‹: pickle.loads, eval(, exec(

[ ] 5. éåº¦æ¬Šé™ï¼Ÿ
    æœå°‹: chmod 777, sudo, --privileged
```

**è‡ªå‹•åŒ–æª¢æŸ¥**:
```bash
# åŸ·è¡Œ pre-commit hooks
git add .
git commit  # æœƒè‡ªå‹•è§¸ç™¼æª¢æŸ¥

# å¦‚æœéœ€è¦æ‰‹å‹•åŸ·è¡Œ
pre-commit run --all-files
```

---

### Code Review æª¢æŸ¥ (å¿…å•çš„ 5 å€‹å•é¡Œ)

1. **é€™æ®µä»£ç¢¼è™•ç†ç”¨æˆ¶è¼¸å…¥å—ï¼Ÿ** â†’ æ˜¯å¦æœ‰è¼¸å…¥é©—è­‰ï¼Ÿ
2. **é€™æ®µä»£ç¢¼æ“ä½œæª”æ¡ˆå—ï¼Ÿ** â†’ æ˜¯å¦æœ‰è·¯å¾‘é©—è­‰ï¼Ÿ
3. **é€™æ®µä»£ç¢¼æŸ¥è©¢è³‡æ–™åº«å—ï¼Ÿ** â†’ æ˜¯å¦ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢ï¼Ÿ
4. **é€™æ®µä»£ç¢¼åŒ…å«æ†‘è­‰å—ï¼Ÿ** â†’ æ˜¯å¦ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ï¼Ÿ
5. **é€™æ®µä»£ç¢¼ååºåˆ—åŒ–æ•¸æ“šå—ï¼Ÿ** â†’ æ˜¯å¦ä½¿ç”¨å®‰å…¨çš„æ ¼å¼ (JSON)?

---

## ğŸ”§ å¿…å‚™å·¥å…·è¨­ç½®

### å·¥å…· #1: git-secrets (å¿…è£)

```bash
# å®‰è£
brew install git-secrets  # macOS
# Linux: https://github.com/awslabs/git-secrets

# åœ¨å°ˆæ¡ˆä¸­å•Ÿç”¨
cd your-project
git secrets --install
git secrets --register-aws
git secrets --add 'sk-[a-zA-Z0-9]{32,}'  # OpenAI keys
```

---

### å·¥å…· #2: pre-commit (å¿…è£)

```bash
# å®‰è£
pip install pre-commit

# åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œ
pre-commit install

# ç¢ºä¿å°ˆæ¡ˆæœ‰ .pre-commit-config.yaml
# åƒè€ƒåœ˜éšŠæ¨™æº–é…ç½®: [å…§éƒ¨ Wiki é€£çµ]
```

---

### å·¥å…· #3: Semgrep (æ¨è–¦)

```bash
# å®‰è£
pip install semgrep

# å®šæœŸæƒæ
semgrep --config "p/owasp-top-ten" .
```

---

## ğŸš¨ æ‡‰æ€¥è™•ç†æµç¨‹

### ç™¼ç¾æ†‘è­‰æ´©æ¼æ™‚

#### ğŸ”´ ç·Šæ€¥è™•ç† (15 åˆ†é˜å…§)

1. **ç«‹å³æ’¤éŠ·** (< 3 åˆ†é˜)
   - ç™»å…¥æœå‹™æä¾›å•† dashboard
   - æ’¤éŠ·æ´©æ¼çš„ key

2. **ç”Ÿæˆæ–°æ†‘è­‰** (< 5 åˆ†é˜)
   - å‰µå»ºæ–° key
   - æ›´æ–° `.env` æ–‡ä»¶

3. **é€šçŸ¥åœ˜éšŠ** (< 5 åˆ†é˜)
   - Slack/Teams é€šçŸ¥: `@channel ç·Šæ€¥ï¼šAPI key æ´©æ¼ï¼Œå·²æ’¤éŠ·`
   - èªªæ˜å½±éŸ¿ç¯„åœ

4. **æ¸…ç† Git æ­·å²** (< 15 åˆ†é˜)
   ```bash
   # ä½¿ç”¨ BFG Repo-Cleaner
   bfg --replace-text secrets.txt .
   git push origin --force --all
   ```

#### ç·Šæ€¥è¯çµ¡äºº

- **Tech Lead**: [Name] - [Phone] - [Email]
- **Security Lead**: [Name] - [Phone] - [Email]
- **On-call Engineer**: åƒè€ƒå€¼ç­è¡¨

---

## ğŸ“ é–‹ç™¼æµç¨‹æ•´åˆ

### æ–°åŠŸèƒ½é–‹ç™¼æµç¨‹

```
1. è¨­è¨ˆ â†’ 2. å¯¦ä½œ â†’ 3. è‡ªæª¢ â†’ 4. æäº¤ â†’ 5. Review â†’ 6. åˆä½µ
           â†“          â†“        â†“         â†“          â†“
        ä½¿ç”¨AI   å®‰å…¨æª¢æŸ¥  pre-commit  äººå·¥å¯©æŸ¥  CI/CDæƒæ
```

#### éšæ®µ 1-2: è¨­è¨ˆèˆ‡å¯¦ä½œ

- å¯è‡ªç”±ä½¿ç”¨ AI è¼”åŠ©é–‹ç™¼å·¥å…·
- è¨˜ä½ï¼šAI æ˜¯åŠ©æ‰‹ï¼Œä¸æ˜¯æ±ºç­–è€…

#### éšæ®µ 3: è‡ªæª¢ (å¿…åš)

```bash
# 1. å¿«é€Ÿæƒæ
git diff | grep -E "(password|api_key|secret|token)"

# 2. åŸ·è¡Œæª¢æŸ¥
pre-commit run --all-files

# 3. æ‰‹å‹•æª¢è¦–
# å•è‡ªå·±ï¼šé€™æ®µä»£ç¢¼å¯ä»¥å…¬é–‹åœ¨ GitHub å—ï¼Ÿ
```

#### éšæ®µ 4: æäº¤

```bash
# Commit æ™‚æœƒè‡ªå‹•è§¸ç™¼ pre-commit hooks
git add .
git commit -m "feat: add new feature"

# å¦‚æœè¢«é˜»æ­¢ï¼Œä¿®å¾©å•é¡Œå¾Œé‡è©¦
```

#### éšæ®µ 5: Code Review

**å¯©æŸ¥è€…è²¬ä»»**:
- [ ] ä½¿ç”¨ã€ŒCode Review æª¢æŸ¥æ¸…å–®ã€é€é …æª¢æŸ¥
- [ ] ç‰¹åˆ¥æ³¨æ„ AI ç”Ÿæˆçš„ä»£ç¢¼æ®µ
- [ ] è‡³å°‘ä¸€ä½ Senior Engineer æ‰¹å‡†

#### éšæ®µ 6: CI/CD

**è‡ªå‹•åŒ–æƒæ** (åœ¨ PR merge å‰):
- Semgrep å®‰å…¨æƒæ
- Bandit æ¼æ´æª¢æ¸¬
- Dependency ç‰ˆæœ¬æª¢æŸ¥ (npm audit / pip-audit)

---

## ğŸ“Š å®šæœŸå®‰å…¨å¯©è¨ˆ

### æ¯é€±

- [ ] æª¢æŸ¥ GitHub Security Alerts
- [ ] æ›´æ–°ä¾è³´å¥—ä»¶ (å¦‚æœ‰å®‰å…¨æ›´æ–°)

### æ¯æœˆ

- [ ] åŸ·è¡Œå…¨å°ˆæ¡ˆ Semgrep æƒæ
- [ ] æª¢æŸ¥ `.env.example` æ˜¯å¦æœ€æ–°
- [ ] å¯©æŸ¥æ–°åŠ å…¥çš„ç¬¬ä¸‰æ–¹å¥—ä»¶

### æ¯å­£

- [ ] å®Œæ•´å®‰å…¨å¯©è¨ˆ (penetration testing)
- [ ] åœ˜éšŠå®‰å…¨åŸ¹è¨“
- [ ] æ›´æ–°å®‰å…¨è¦ç¯„æ–‡æª”
- [ ] æ‡‰æ€¥æ¼”ç·´ (æ¨¡æ“¬æ´©æ¼äº‹ä»¶)

---

## ğŸ“ åŸ¹è¨“èˆ‡èªè­‰

### æ–°æˆå“¡å¿…ä¿®

- [ ] é–±è®€æœ¬è¦ç¯„æ–‡æª”
- [ ] å®Œæˆã€Œå®‰å…¨èˆ‡æœ€ä½³å¯¦è¸ã€æ¨¡çµ„å­¸ç¿’
- [ ] åœ¨æ¸¬è©¦å°ˆæ¡ˆä¸­è¨­ç½®å®Œæ•´å·¥å…·éˆ
- [ ] é€šéå®‰å…¨æ„è­˜æ¸¬é©— (80 åˆ†ä»¥ä¸Š)

### å®‰å…¨æ¸¬é©—ç¯„ä¾‹

1. çœ‹åˆ° `api_key = "sk-..."` æ‡‰è©²æ€éº¼åšï¼Ÿ
2. å¦‚ä½•å®‰å…¨åœ°åŸ·è¡ŒåŒ…å«ç”¨æˆ¶è¼¸å…¥çš„ SQL æŸ¥è©¢ï¼Ÿ
3. ç™¼ç¾ API key æ´©æ¼ï¼Œå‰ 3 å€‹æ­¥é©Ÿæ˜¯ï¼Ÿ
4. `chmod 777` æœ‰ä»€éº¼å•é¡Œï¼Ÿ
5. ç‚ºä»€éº¼ `pickle.loads(user_input)` å±éšªï¼Ÿ

---

## ğŸ”— åƒè€ƒè³‡æº

### å…§éƒ¨è³‡æº

- **å·¥å…·è¨­ç½®æŒ‡å—**: [å…§éƒ¨ Wiki é€£çµ]
- **æ‡‰æ€¥è™•ç† Runbook**: [å…§éƒ¨æ–‡æª”]
- **å®‰å…¨äº‹ä»¶å ±å‘Šç¯„æœ¬**: [å…§éƒ¨è¡¨å–®]

### å¤–éƒ¨è³‡æº

- **OWASP Top 10**: https://owasp.org/www-project-top-ten/
- **CWE Top 25**: https://cwe.mitre.org/top25/
- **Python Security Best Practices**: https://snyk.io/blog/python-security-best-practices/
- **Node.js Security Checklist**: https://blog.risingstack.com/node-js-security-checklist/

---

## ğŸ“œ è¦ç¯„æ›´æ–°è¨˜éŒ„

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å…§å®¹ | æ›´æ–°è€… |
|------|------|----------|--------|
| 1.0 | 2025-01-01 | åˆå§‹ç‰ˆæœ¬ | [Name] |
| 1.1 | 2025-02-15 | æ–°å¢ Semgrep è¦ç¯„ | [Name] |

---

## ğŸ’¬ æ„è¦‹å›é¥‹

å¦‚æœä½ èªç‚ºæœ¬è¦ç¯„æœ‰æ”¹é€²ç©ºé–“ï¼Œè«‹ï¼š
1. åœ¨åœ˜éšŠæœƒè­°æå‡ºè¨è«–
2. æˆ–æäº¤ Issue: [å…§éƒ¨ Issue Tracker]

---

**è¨˜ä½**ï¼š

> **ã€Œå®‰å…¨ä¸æ˜¯ä¸€æ¬¡æ€§ä»»å‹™ï¼Œè€Œæ˜¯æŒçºŒçš„ç¿’æ…£ã€**
> **ã€Œåœ˜éšŠçš„å®‰å…¨æ€§å–æ±ºæ–¼æœ€è–„å¼±çš„ä¸€ç’°ã€**

è®“æˆ‘å€‘å…±åŒç¶­è­·åœ˜éšŠä»£ç¢¼çš„å®‰å…¨æ€§ï¼
