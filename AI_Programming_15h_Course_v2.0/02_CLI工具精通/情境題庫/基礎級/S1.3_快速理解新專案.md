# S1.3：快速理解新專案

## 📋 情境資訊

- **難度**：⭐
- **預估時間**：45 分鐘
- **核心學習**：`--add-dir` 專案導入、`/context` 上下文管理、程式碼架構理解
- **前置知識**：Claude Code 基本操作、檔案系統概念

---

## 🎯 情境背景

你剛加入一個新團隊，需要接手維護一個中型 Python Web 專案。這是一個使用 FastAPI 框架的電商後端 API，包含用戶管理、商品管理、訂單處理等模組。專案已運行 2 年，程式碼庫約 50 個檔案，但缺乏完整文檔，前任開發者已離職。

**專案基本資訊**:
- 程式語言：Python (FastAPI)
- 程式碼庫大小：~15,000 行程式碼
- 主要目錄：app/, tests/, docs/, config/
- 資料庫：PostgreSQL + SQLAlchemy
- 部署：Docker + Kubernetes
- 你需要在今天內對專案有基本了解，明天就要修復一個 bug

**你的任務**:
1. 快速理解專案整體架構
2. 識別主要功能模組和檔案
3. 了解資料模型和 API 結構
4. 找出專案的配置和部署流程
5. 建立專案的心智模型，為後續開發做準備

---

## 🎓 學習目標

完成本情境後，你將能夠：

- ✅ 使用 `--add-dir` 快速導入整個專案
- ✅ 運用 `/context` 管理和切換不同分析焦點
- ✅ 系統性分析專案架構和依賴關係
- ✅ 快速識別關鍵檔案和程式碼模式
- ✅ 提取專案技術棧和設計理念
- ✅ 建立個人化的專案理解筆記

---

## 📝 任務描述

### 階段 1: 專案導入與初步掃描 (10 分鐘)

#### 任務 1.1: 完整專案導入

**Linux 類比**: 像使用 `find` 和 `head` 快速瀏覽專案，但 Claude Code 提供語義理解。

假設專案路徑為 `~/projects/ecommerce-api`：

```bash
# 1. 進入專案目錄
cd ~/projects/ecommerce-api

# 2. 使用 Claude Code 導入整個專案
claude --add-dir .
```

**初步對話**:
```
我需要快速理解這個 Python 專案。這是一個電商後端 API，我是新接手的開發者。

請先幫我：
1. 分析專案整體結構
2. 識別專案類型和技術棧
3. 找出主要的配置檔案
4. 評估程式碼規模和複雜度
```

**預期輸出**:
Claude 會分析所有檔案並提供：
- 專案結構樹狀圖
- 技術棧清單
- 主要目錄和檔案說明
- 程式碼規模統計

#### 任務 1.2: 關鍵檔案識別

繼續對話：

```
請幫我識別這個專案的關鍵檔案：

/read README.md
/read requirements.txt
/read pyproject.toml

然後分析：
1. 專案的主要功能是什麼？
2. 如何啟動和部署？
3. 有哪些主要依賴？
```

**檢查點 1**:
- [ ] 專案已完整導入 Claude Code
- [ ] 理解專案的基本資訊和技術棧
- [ ] 識別出主要配置檔案

---

### 階段 2: 程式碼架構深度分析 (15 分鐘)

#### 任務 2.1: 程式碼結構理解

**設定分析上下文**:
```
/context "專案架構分析"

現在我要深入理解程式碼架構。請幫我分析：

/glob "app/**/*.py"

根據這些 Python 檔案，請說明：
1. 專案採用什麼架構模式？（MVC、分層架構等）
2. 主要的業務模組有哪些？
3. 檔案之間的依賴關係如何？
```

#### 任務 2.2: 核心檔案詳細分析

```
請幫我讀取和分析核心檔案：

/read app/main.py
/read app/models/
/read app/api/

分析重點：
1. API 路由結構
2. 資料模型設計
3. 主要業務邏輯流程
4. 錯誤處理機制
```

#### 任務 2.3: 資料庫和配置分析

```
/context "資料庫和配置"

/read app/models.py
/read config/database.py
/read .env.example

請幫我理解：
1. 資料庫架構設計
2. 主要的資料表關係
3. 配置項目和環境變數
4. 資料庫遷移機制
```

**檢查點 2**:
- [ ] 理解專案的整體架構模式
- [ ] 掌握主要業務模組和功能
- [ ] 了解資料庫設計和配置

---

### 階段 3: API 和業務流程理解 (15 分鐘)

#### 任務 3.1: API 端點分析

```
/context "API 端點分析"

請幫我分析所有 API 端點：

/grep "app.router\|@router\|@app" --output-mode=content

然後整理成：
1. API 端點清單
2. 每個端點的功能說明
3. 請求/回應格式
4. 權限控制機制
```

#### 任務 3.2: 業務流程理解

```
請幫我追蹤一個典型的業務流程，比如"用戶下單"：

/grep "order\|Order" --output-mode=content

分析：
1. 訂單建立的完整流程
2. 涉及哪些模組和函數
3. 資料驗證和錯誤處理
4. 外部服務整合點
```

#### 任務 3.3: 測試和文檔理解

```
/context "測試和文檔"

/glob "tests/**/*.py"
/read docs/

請幫我了解：
1. 測試覆蓋情況
2. 主要的測試類型和策略
3. 現有文檔的完整性
4. 開發和部署流程
```

**檢查點 3**:
- [ ] 掌握主要 API 端點和功能
- [ ] 理解核心業務流程
- [ ] 了解測試和文檔狀況

---

### 階段 4: 總結和個人筆記 (5 分鐘)

#### 任務 4.1: 生成專案理解報告

```
/context "專案總結"

請根據剛才的分析，幫我生成一份新手開發者的專案理解報告，包括：

1. **專案概覽**
   - 技術棧總結
   - 主要功能模組
   - 程式碼規模和複雜度

2. **架構理解**
   - 目錄結構圖
   - 核心設計模式
   - 關鍵檔案說明

3. **開發指南**
   - 本地開發環境設置
   - 常用開發指令
   - 調試和測試方法

4. **注意事項**
   - 程式碼品質評估
   - 潛在風險點
   - 改進建議

5. **快速參考**
   - 重要檔案位置
   - 常用 API 端點
   - 配置項目清單
```

#### 任務 4.2: 建立個人化 CLAUDE.md

```
請幫我建立一個這個專案的 CLAUDE.md 檔案，作為我後續開發的參考。

內容應包括：
- 專案背景和架構總結
- 常見開發任務的指引
- 關鍵檔案和程式碼位置
- 我需要特別關注的地方

請以適合 Claude Code 讀取的格式撰寫。
```

**最終檢查點**:
- [ ] 獲得完整的專案理解報告
- [ ] 建立個人化的專案筆記
- [ ] 對專案架構有清晰的心智模型

---

## ✅ 檢查點

### 基礎檢查點 (必須完成)

- [ ] **專案導入**: 使用 `--add-dir` 成功導入整個專案
- [ ] **架構理解**: 能說明專案的主要技術棧和架構模式
- [ ] **檔案導航**: 知道關鍵功能在哪些檔案中實現
- [ ] **API 掌握**: 了解主要 API 端點和業務流程
- [ ] **上下文管理**: 熟練使用 `/context` 組織分析焦點

### 進階檢查點 (建議完成)

- [ ] **深度理解**: 能追蹤複雜業務流程的實現細節
- [ ] **問題識別**: 發現程式碼中的潛在問題或改進點
- [ ] **文檔產出**: 生成高品質的專案理解文檔
- [ ] **開發就緒**: 有信心開始進行開發和調試
- [ ] **知識沉澱**: 建立了可複用的專案分析方法

---

## 🎯 自然學到的指令

通過本情境，你應該自然學會以下指令組合：

### 專案導入和管理

| 指令 | 用途 | 何時使用 |
|------|------|----------|
| `claude --add-dir .` | 導入整個專案目錄 | 開始分析新專案時 |
| `/context "[主題]"` | 設定分析上下文 | 切換分析焦點時 |
| `/glob "**/*.py"` | 按檔案類型篩選 | 分析特定語言程式碼 |
| `/grep "[pattern]"` | 搜尋程式碼模式 | 追蹤函數、類別、變數 |

### 程式碼理解組合

| 組合模式 | 用途 | 實例 |
|----------|------|------|
| `/read` + 架構分析 | 理解關鍵檔案 | `/read app/main.py` + 分析入口點 |
| `/glob` + `/grep` | 找出相關程式碼 | 找出所有 API 路由定義 |
| `/context` + 深度分析 | 聚焦特定主題 | 專注資料庫或 API 設計 |

### 工作流程模式

**模式 1: 由外而內分析**
```
--add-dir → 整體架構 → /glob 分類 → /read 關鍵檔案 → /grep 細節
```

**模式 2: 主題式深度分析**
```
/context 設定主題 → /glob 相關檔案 → /read 逐一分析 → 總結理解
```

**模式 3: 業務流程追蹤**
```
/grep 關鍵字 → /read 相關檔案 → 追蹤函數調用 → 理解完整流程
```

---

## ❓ 常見問題

### Q1: 專案導入後 Claude 回應很慢

**原因**: 專案檔案過多或包含大量二進位檔案

**解決方法**:
```bash
# 排除不必要的目錄
claude --add-dir . --exclude "node_modules,*.git,__pycache__,*.egg-info"

# 或分批導入重要目錄
claude --add-dir app/
claude --add-dir tests/
claude --add-dir config/
```

---

### Q2: 無法理解複雜的程式碼關係

**策略**: 分層漸進式分析

**解決方法**:
```
# 1. 先理解單個檔案
/read app/models/user.py
請說明這個檔案的作用

# 2. 再理解檔案間關係
/grep "from.*user" --output-mode=content
請說明 user 模組如何被其他模組使用

# 3. 最後理解整體流程
請追蹤用戶註冊的完整流程，涉及哪些檔案？
```

---

### Q3: 專案文檔不完整，難以理解業務邏輯

**方法**: 從程式碼推斷業務邏輯

**解決方法**:
```
# 分析 API 端點了解業務功能
/grep "@router\|@app" --output-mode=content

# 分析資料模型了解業務實體
/read app/models/

# 分析測試了解使用案例
/read tests/test_api.py

請根據這些程式碼，推斷這個專案的主要業務流程。
```

---

### Q4: 如何快速找到特定功能的實現？

**搜尋策略**:
```
# 1. 關鍵字搜尋
/grep "login\|auth" --output-mode=files_with_matches

# 2. 檔案名模式
/glob "*auth*" "*login*" "*user*"

# 3. 程式碼模式
/grep "def.*login\|class.*Auth" --output-mode=content

# 4. 結合上下文
/context "身份驗證"
請分析這個專案的身份驗證機制
```

---

## 🚀 延伸挑戰

### 挑戰 1: 建立專案地圖

**任務**: 創建專案的視覺化架構圖

**要求**:
- 模組依賴關係圖
- 資料流向圖
- API 調用關係
- 檔案重要性評級

**實作提示**:
```
請分析專案中的 import 關係，生成模組依賴圖：

/grep "from.*import\|import.*from" --output-mode=content

並建立一個 Mermaid 格式的架構圖。
```

---

### 挑戰 2: 程式碼品質評估

**任務**: 對專案進行全面的程式碼品質分析

**分析面向**:
- 程式碼複雜度和可讀性
- 測試覆蓋率和品質
- 安全漏洞和風險點
- 性能瓶頸識別
- 重構機會

**實作範例**:
```
請幫我評估這個專案的程式碼品質：

1. 複雜度分析：
/grep "def.*(" --output-mode=content | head -20
分析函數複雜度

2. 安全性檢查：
/grep "eval\|exec\|os\.system\|subprocess" --output-mode=content
檢查潛在安全風險

3. 最佳實踐檢查：
檢查是否遵循 Python 和 FastAPI 最佳實踐
```

---

### 挑戰 3: 自動化專案分析工具

**任務**: 建立可複用的專案分析工作流程

**目標**:
- 標準化分析流程
- 自動生成分析報告
- 建立專案類型檢測
- 提供改進建議

**工具設計**:
```bash
#!/bin/bash
# project-analyzer.sh

echo "開始分析專案..."

# 1. 檢測專案類型
if [ -f "package.json" ]; then
    PROJECT_TYPE="Node.js"
elif [ -f "requirements.txt" ] || [ -f "pyproject.toml" ]; then
    PROJECT_TYPE="Python"
elif [ -f "pom.xml" ]; then
    PROJECT_TYPE="Java"
fi

echo "檢測到專案類型: $PROJECT_TYPE"

# 2. 執行 Claude Code 分析
claude --add-dir . << EOF
我需要分析這個 $PROJECT_TYPE 專案，請提供：
1. 架構概覽
2. 技術棧分析
3. 程式碼品質評估
4. 改進建議

生成的報告請保存為 PROJECT_ANALYSIS.md
EOF

echo "分析完成，報告保存在 PROJECT_ANALYSIS.md"
```

---

## 📚 相關資源

### 專案分析最佳實踐

| 分析階段 | 關注重點 | 工具建議 |
|----------|----------|----------|
| **概覽階段** | 整體架構、技術棧 | `/glob`, 目錄瀏覽 |
| **結構階段** | 模組關係、設計模式 | `/grep`, `/read` |
| **業務階段** | 核心流程、API 設計 | 上下文分析 |
| **品質階段** | 程式碼品質、測試 | 模式搜尋 |

### 課程資源

- **理論**: `2.3_程式碼庫分析技巧.md`
- **下一步**: `S1.4_生成專案文檔.md`

### 技術棧對應策略

| 專案類型 | 關鍵檔案 | 分析重點 |
|----------|----------|----------|
| **Python** | `requirements.txt`, `main.py` | 框架識別、模組結構 |
| **Node.js** | `package.json`, `app.js` | 依賴分析、路由結構 |
| **Java** | `pom.xml`, `Application.java` | 配置管理、層次架構 |
| **React** | `package.json`, `src/App.js` | 組件結構、狀態管理 |

---

## 📝 反思問題

完成情境後，思考以下問題：

1. **學習效率**: 使用 Claude Code 分析專案比傳統方法快多少？優勢在哪裡？

2. **理解深度**: 45 分鐘的分析讓你對專案的理解達到什麼程度？

3. **方法論**: 你建立了什麼樣的專案分析方法論？可以應用到其他專案嗎？

4. **工具使用**: 哪些 Claude Code 功能在專案理解中最有價值？

5. **知識管理**: 如何組織和保存專案分析的結果，以便後續參考？

---

**情境版本**: v1.0
**最後更新**: 2025-01-30
**預估完成率**: 80% 學員能在 45 分鐘內建立基本專案理解
**常見卡點**: 上下文管理 (25%), 程式碼關係理解 (20%)