# S1.2：混亂資料夾整理

## 📋 情境資訊

- **難度**：⭐
- **預估時間**：30 分鐘
- **核心學習**：基本互動指令、檔案操作、資料夾結構分析
- **前置知識**：Claude Code 已安裝配置

---

## 🎯 情境背景

你剛接手了一位前同事的工作電腦，發現 Downloads 資料夾裡有 100+ 個檔案混雜在一起：專案文件、圖片、壓縮檔、程式碼、PDF 文件等各種格式的檔案都堆在一起。你需要快速整理這些檔案，建立有組織的目錄結構。

**現況描述**:
- Downloads 資料夾包含 150+ 個檔案
- 檔案類型混雜：.pdf, .jpg, .png, .zip, .py, .js, .txt, .docx 等
- 檔案命名不規範：有些是 "未命名1.pdf"、"新增資料夾 (2)" 等
- 需要快速分類並建立合理的目錄結構
- 部分檔案可能重複或已過時

**你的任務**:
1. 分析現有檔案結構和類型分布
2. 設計合理的分類方案
3. 建立目錄結構
4. 批量移動和重新組織檔案
5. 清理重複或無用檔案

---

## 🎓 學習目標

完成本情境後，你將能夠：

- ✅ 使用 Claude Code 分析大量檔案結構
- ✅ 運用 `/glob` 指令搜尋特定類型檔案
- ✅ 結合 `/bash` 執行檔案操作
- ✅ 設計合理的檔案組織架構
- ✅ 批量處理檔案移動和重新命名
- ✅ 生成檔案清理報告

---

## 📝 任務描述

### 階段 1: 現況分析 (10 分鐘)

#### 任務 1.1: 檔案類型統計

**Linux 類比**: 像使用 `find` 和 `wc` 統計目錄內容，但 Claude Code 提供更智能的分析。

**執行步驟**:

```bash
# 1. 進入 Downloads 目錄
cd ~/Downloads

# 2. 啟動 Claude Code 並分析檔案
claude
```

在 Claude Code 中執行：

```
我需要整理這個混亂的 Downloads 資料夾，請幫我分析檔案結構。

/glob "**/*"
```

**追加分析請求**:
```
請根據 glob 結果，幫我：
1. 統計各種檔案類型的數量
2. 識別檔案大小分布
3. 找出可能的重複檔案模式
4. 建議分類方案
```

**預期結果**:
Claude 會分析所有檔案，提供：
- 檔案類型統計表
- 大檔案清單
- 疑似重複檔案
- 建議的目錄結構

#### 任務 1.2: 識別問題檔案

繼續在 Claude Code 中：

```
/grep "\(未命名\|新增資料夾\|copy\|副本\)" --output-mode=files_with_matches

請幫我找出以下問題檔案：
1. 命名不規範的檔案
2. 可能的重複檔案
3. 臨時或無用檔案
```

**檢查點 1**:
- [ ] 完成檔案類型統計
- [ ] 識別出主要檔案類別（圖片、文件、程式碼等）
- [ ] 找出問題檔案清單

---

### 階段 2: 設計目錄結構 (5 分鐘)

#### 任務 2.1: 規劃目錄架構

與 Claude 討論整理方案：

```
根據分析結果，請幫我設計一個合理的目錄結構來整理這些檔案。

考慮因素：
- 檔案類型和用途
- 時間順序（如按年份）
- 專案歸屬
- 使用頻率

請提供具體的目錄結構和移動計劃。
```

**預期輸出範例**:
```
建議目錄結構：
📁 Documents/
  ├── 📁 PDFs/
  ├── 📁 Office_Files/
  └── 📁 Archive_2024/
📁 Images/
  ├── 📁 Screenshots/
  ├── 📁 Photos/
  └── 📁 Design/
📁 Code/
  ├── 📁 Projects/
  ├── 📁 Scripts/
  └── 📁 Archive/
📁 Compressed/
📁 Temp/
  └── 📁 ToReview/
```

#### 任務 2.2: 生成建立指令

```
請生成建立這個目錄結構的 bash 指令，我想要一次執行完成。
```

**檢查點 2**:
- [ ] 設計出清晰的目錄結構
- [ ] 獲得具體的 mkdir 指令列表

---

### 階段 3: 執行檔案整理 (12 分鐘)

#### 任務 3.1: 建立目錄結構

使用 Claude 提供的指令：

```bash
# 執行 Claude 建議的目錄建立指令
mkdir -p Documents/{PDFs,Office_Files,Archive_2024}
mkdir -p Images/{Screenshots,Photos,Design}
mkdir -p Code/{Projects,Scripts,Archive}
mkdir -p Compressed Temp/ToReview
```

#### 任務 3.2: 批量移動檔案

回到 Claude Code：

```
現在目錄結構已建立，請幫我生成移動檔案的 bash 指令。

請分類型處理：
1. 先處理圖片檔案（.jpg, .png, .gif 等）
2. 再處理文件檔案（.pdf, .docx, .txt 等）
3. 然後是程式碼檔案（.py, .js, .html 等）
4. 最後處理壓縮檔案

每個類別請提供對應的 mv 指令。
```

**執行移動指令範例**:

```bash
# 移動圖片檔案
mv *.jpg *.jpeg *.png *.gif Images/Photos/ 2>/dev/null || true

# 移動螢幕截圖（通常包含 Screenshot 或時間戳記）
mv *Screenshot* *螢幕截圖* Images/Screenshots/ 2>/dev/null || true

# 移動 PDF 文件
mv *.pdf Documents/PDFs/ 2>/dev/null || true

# 移動 Office 檔案
mv *.docx *.xlsx *.pptx Documents/Office_Files/ 2>/dev/null || true

# 移動程式碼檔案
mv *.py *.js *.html *.css Code/Scripts/ 2>/dev/null || true

# 移動壓縮檔案
mv *.zip *.rar *.tar.gz Compressed/ 2>/dev/null || true
```

#### 任務 3.3: 處理問題檔案

```
/bash ls -la | grep -E "(未命名|新增|copy|副本)"

請幫我處理這些命名不規範的檔案，提供重新命名或移動到 Temp/ToReview 的指令。
```

**檢查點 3**:
- [ ] 成功建立目錄結構
- [ ] 完成主要檔案類型的移動
- [ ] 處理問題檔案

---

### 階段 4: 驗證和清理 (3 分鐘)

#### 任務 4.1: 生成整理報告

```
請幫我檢查整理結果：

/bash tree -L 2 .

並生成一份整理報告，包括：
1. 移動了多少檔案到各個目錄
2. 還有哪些檔案需要手動處理
3. 建議的後續維護建議
```

#### 任務 4.2: 清理驗證

```
/bash ls -la | head -20

檢查是否還有檔案留在根目錄需要處理，並提供清理建議。
```

**最終檢查點**:
- [ ] Downloads 根目錄基本清空
- [ ] 檔案按類別正確分類
- [ ] 生成整理報告
- [ ] 確認無重要檔案遺失

---

## ✅ 檢查點

### 基礎檢查點 (必須完成)

- [ ] **檔案分析**: 使用 `/glob` 成功分析檔案結構
- [ ] **目錄建立**: 建立了合理的目錄分類架構
- [ ] **批量移動**: 至少 80% 檔案移動到正確分類
- [ ] **基本清理**: Downloads 根目錄檔案數量顯著減少
- [ ] **指令熟練**: 能組合使用 `/glob`, `/bash`, 基本對話

### 進階檢查點 (建議完成)

- [ ] **智能分類**: 根據檔案內容特徵進行分類（如區分截圖和照片）
- [ ] **重複檔案**: 識別並處理重複檔案
- [ ] **自動化腳本**: 將整理過程整理成可重複使用的腳本
- [ ] **維護計劃**: 制定未來檔案管理策略
- [ ] **報告生成**: 產出詳細的整理前後對比報告

---

## 🎯 自然學到的指令

通過本情境，你應該自然學會以下指令組合：

### 檔案探索指令

| 指令 | 用途 | 何時使用 |
|------|------|----------|
| `/glob "**/*"` | 遞迴列出所有檔案 | 分析目錄結構、檔案統計 |
| `/glob "*.{jpg,png,gif}"` | 按副檔名模式搜尋 | 找出特定類型檔案 |
| `/bash ls -la` | 詳細列出檔案資訊 | 檢查檔案權限、大小、時間 |
| `/bash tree` | 顯示目錄樹狀結構 | 視覺化目錄架構 |

### 檔案操作指令

| 指令 | 用途 | 何時使用 |
|------|------|----------|
| `/bash mkdir -p [dirs]` | 建立多層目錄 | 一次建立整個目錄結構 |
| `/bash mv [pattern] [dest]` | 批量移動檔案 | 重新組織檔案位置 |
| `/grep [pattern]` | 搜尋檔案名模式 | 找出問題檔案、重複檔案 |

### 工作流程模式

**模式 1: 分析 → 規劃 → 執行**
```
/glob → 分析檔案 → 設計結構 → /bash 執行移動 → 驗證結果
```

**模式 2: 問題導向處理**
```
/grep 找問題 → 討論解決方案 → /bash 執行修復 → 再次檢查
```

---

## ❓ 常見問題

### Q1: 移動檔案時出現 "Permission denied"

**原因**: 檔案權限不足或目標目錄不存在

**解決方法**:
```bash
# 檢查目標目錄是否存在
ls -la Documents/

# 如果不存在，建立目錄
mkdir -p Documents/PDFs

# 檢查檔案權限
ls -la *.pdf

# 如果需要，修改權限
chmod 644 *.pdf
```

---

### Q2: glob 模式匹配不到預期檔案

**常見原因**: 檔案名包含特殊字元或空格

**解決方法**:
```
# 使用引號包含模式
/glob "**/*.pdf"

# 搜尋包含空格的檔案
/bash find . -name "* *" -type f

# 讓 Claude 協助處理特殊字元
請幫我搜尋檔案名包含空格或特殊字元的檔案
```

---

### Q3: 不確定檔案是否重要，不敢刪除

**安全策略**:
```
# 先移動到暫存區，不要直接刪除
mkdir -p Temp/ToReview

# 移動不確定的檔案
mv "未命名*" Temp/ToReview/

# 讓 Claude 幫助判斷
請幫我檢查 Temp/ToReview 中的檔案，判斷哪些可以安全刪除
```

---

### Q4: 批量操作後發現檔案移動錯誤

**回復策略**:
```bash
# 查看操作歷史
history | grep mv

# 如果可能，執行反向操作
# 例如：將錯誤移動到 Images/ 的 .txt 檔案移回
mv Images/*.txt Documents/

# 或讓 Claude 協助生成反向指令
請根據我剛才的移動操作，生成復原指令
```

---

## 🚀 延伸挑戰

### 挑戰 1: 智能檔案分類

**任務**: 基於檔案內容而非僅僅副檔名進行分類

**例如**:
- 區分程式碼截圖和一般截圖
- 分離工作文件和個人文件
- 按專案歸類相關檔案

**實作提示**:
```
請幫我分析這些 .png 檔案，哪些是程式碼截圖，哪些是照片？

/bash file *.png | head -10

根據檔案大小、尺寸、命名模式來判斷類型。
```

---

### 挑戰 2: 自動化整理腳本

**任務**: 將整理過程寫成可重複使用的 bash 腳本

**要求**:
- 檢查目錄結構是否存在
- 提供安全確認機制
- 生成操作日誌
- 支援回復操作

**範例腳本結構**:
```bash
#!/bin/bash
# downloads-organizer.sh

# 設定變數
SOURCE_DIR="$HOME/Downloads"
BACKUP_DIR="$HOME/.downloads_backup"

# 安全檢查
echo "即將整理目錄: $SOURCE_DIR"
echo "是否繼續？ (y/N)"
read -r response

if [[ "$response" =~ ^[Yy]$ ]]; then
    # 建立備份
    cp -r "$SOURCE_DIR" "$BACKUP_DIR"

    # 執行整理
    # ... 整理邏輯

    echo "整理完成！備份位於: $BACKUP_DIR"
else
    echo "操作已取消"
fi
```

---

### 挑戰 3: 持續維護系統

**任務**: 建立長期的檔案管理策略

**要求**:
- 設定定期清理提醒
- 建立檔案命名規範
- 設定 Watch 資料夾自動分類
- 整合到日常工作流程

**實作範例**:
```bash
# 設定每週清理提醒 (crontab)
0 10 * * MON /home/user/scripts/downloads-cleanup.sh

# 使用 inotify 監控新檔案
inotifywait -m ~/Downloads -e create --format '%w%f' | while read file; do
    # 根據檔案類型自動移動
    case "$file" in
        *.pdf) mv "$file" ~/Documents/PDFs/ ;;
        *.jpg|*.png) mv "$file" ~/Images/ ;;
        # ... 其他規則
    esac
done
```

---

## 📚 相關資源

### Linux 指令對照

| 任務 | Linux 傳統方式 | Claude Code 方式 |
|------|---------------|------------------|
| 檔案統計 | `find . -type f \| wc -l` | `/glob "**/*"` + 分析 |
| 按類型分類 | `find . -name "*.pdf"` | `/glob "*.pdf"` |
| 批量操作 | 複雜的 for 迴圈 | Claude 生成 + `/bash` |
| 目錄分析 | `tree`, `du`, `ls` 組合 | 智能分析對話 |

### 課程資源

- **理論**: `2.2_檔案系統操作.md`
- **下一步**: `S1.3_快速理解新專案.md`

### 最佳實踐

1. **安全第一**: 永遠先備份重要檔案
2. **漸進處理**: 一次處理一種檔案類型
3. **驗證結果**: 每步操作後都要檢查
4. **記錄過程**: 保存成功的指令以供重複使用

---

## 📝 反思問題

完成情境後，思考以下問題：

1. **效率對比**: 相比手動整理，Claude Code 協助的效率提升如何？

2. **智能程度**: Claude 在檔案分類建議上展現了哪些"理解力"？

3. **指令學習**: 哪些 `/glob` 和 `/bash` 的組合讓你印象深刻？

4. **錯誤處理**: 在批量操作中，如何平衡效率和安全性？

5. **自動化思考**: 類似的檔案整理任務，如何設計自動化解決方案？

---

**情境版本**: v1.0
**最後更新**: 2025-01-30
**預估完成率**: 85% 學員能在 30 分鐘內完成基本整理
**常見卡點**: bash 指令組合 (20%), 檔案權限問題 (15%)