# DDD 與 AI 記憶卡庫

## 📋 記憶卡庫概述

本記憶卡庫包含 50+ 張情境式記憶卡，幫助你內化 DDD 概念與 AI 輔助工作流程。

**核心理念**：
> 記憶卡不是背定義，而是在情境中應用。
> 每張卡片都是一個真實場景，需要你做出決策。

---

## 🎯 記憶卡分類

### Category 1：DDD 核心概念（10 張）

**學習目標**：理解 DDD 核心概念的本質與應用場景

| 卡片 ID | 問題類型 | 難度 |
|---------|---------|------|
| C1-01 | 通用語言識別 | 基礎 |
| C1-02 | 限界上下文劃分 | 中等 |
| C1-03 | 聚合邊界判斷 | 中等 |
| C1-04 | 實體 vs 值對象 | 基礎 |
| C1-05 | 領域事件設計 | 中等 |
| C1-06 | 業務規則位置 | 進階 |
| C1-07 | 上下文關係 | 中等 |
| C1-08 | DDD 適用場景 | 基礎 |
| C1-09 | 聚合大小判斷 | 進階 |
| C1-10 | 防腐層設計 | 進階 |

### Category 2：AI 輔助 DDD 流程（10 張）

**學習目標**：掌握 AI 輔助的 5 個階段工作流程

| 卡片 ID | 問題類型 | 難度 |
|---------|---------|------|
| C2-01 | 通用語言提取策略 | 基礎 |
| C2-02 | 事件風暴提示詞 | 中等 |
| C2-03 | AI Agent 選擇 | 基礎 |
| C2-04 | AI 輸出驗證 | 中等 |
| C2-05 | 上下文劃分提示詞 | 中等 |
| C2-06 | 領域模型生成 | 進階 |
| C2-07 | AI 的局限性 | 進階 |
| C2-08 | 多方案對比 | 進階 |
| C2-09 | 程式碼骨架生成 | 中等 |
| C2-10 | 迭代優化流程 | 進階 |

### Category 3：聚合設計技巧（10 張）

**學習目標**：掌握聚合設計的最佳實踐

| 卡片 ID | 問題類型 | 難度 |
|---------|---------|------|
| C3-01 | 聚合根選擇 | 中等 |
| C3-02 | 一致性邊界 | 中等 |
| C3-03 | 聚合引用方式 | 進階 |
| C3-04 | 聚合拆分時機 | 進階 |
| C3-05 | 業務方法設計 | 中等 |
| C3-06 | 不變性保護 | 進階 |
| C3-07 | 聚合事務邊界 | 進階 |
| C3-08 | 聚合併發處理 | 進階 |
| C3-09 | 聚合測試策略 | 中等 |
| C3-10 | 聚合重構技巧 | 進階 |

### Category 4：值對象與實體（10 張）

**學習目標**：區分實體與值對象，掌握設計原則

| 卡片 ID | 問題類型 | 難度 |
|---------|---------|------|
| C4-01 | 實體 vs 值對象判斷 | 基礎 |
| C4-02 | 值對象不可變性 | 基礎 |
| C4-03 | 值對象運算設計 | 中等 |
| C4-04 | 實體生命週期 | 中等 |
| C4-05 | 值對象驗證邏輯 | 中等 |
| C4-06 | 實體 ID 設計 | 進階 |
| C4-07 | 值對象相等性 | 基礎 |
| C4-08 | 實體引用 vs 值對象 | 中等 |
| C4-09 | 值對象持久化 | 進階 |
| C4-10 | 實體 vs 聚合根 | 進階 |

### Category 5：領域事件與解耦（10 張）

**學習目標**：掌握領域事件的設計與使用

| 卡片 ID | 問題類型 | 難度 |
|---------|---------|------|
| C5-01 | 領域事件命名 | 基礎 |
| C5-02 | 事件攜帶資訊 | 中等 |
| C5-03 | 事件發布時機 | 中等 |
| C5-04 | 事件 vs 命令 | 中等 |
| C5-05 | 事件處理失敗 | 進階 |
| C5-06 | 事件溯源設計 | 進階 |
| C5-07 | 事件版本演進 | 進階 |
| C5-08 | 事件順序保證 | 進階 |
| C5-09 | 事件驅動架構 | 進階 |
| C5-10 | 事件 vs API 調用 | 中等 |

---

## 📚 記憶卡格式

每張記憶卡遵循以下格式：

### 正面（問題）

```markdown
【情境】
你正在設計一個電商系統。業務需求：
「用戶下單後，系統需要鎖定庫存、記錄支付資訊、發送通知郵件。」

【問題】
Order 聚合應該包含哪些實體和值對象？
Payment 和 Inventory 應該是獨立聚合嗎？

【選項】
A. Order 聚合包含 Payment 和 Inventory
B. Order、Payment、Inventory 都是獨立聚合，通過事件通訊
C. Order 聚合包含 OrderItem，Payment 和 Inventory 是獨立聚合
D. Order 和 Payment 合併，Inventory 獨立

請選擇並說明理由。
```

### 背面（解答）

```markdown
【正確答案】C

【解析】
1. **Order 聚合包含 OrderItem**：
   - 訂單項與訂單必須保持一致性（修改數量 → 總金額變化）
   - 屬於同一個事務邊界

2. **Payment 是獨立聚合**：
   - 支付與訂單可以最終一致性
   - 支付系統可能有獨立的團隊維護
   - 通過 OrderPaid 事件通訊

3. **Inventory 是獨立聚合**：
   - 庫存管理是獨立的業務邏輯
   - 通過 OrderSubmitted 事件鎖定庫存
   - 通過 OrderCancelled 事件釋放庫存

【關鍵原則】
- 聚合內：強一致性（同一事務）
- 聚合間：最終一致性（事件驅動）

【記憶點】
「訂單只管訂單的事，支付和庫存讓他們自己管自己。」
```

---

## 🎓 使用指南

### 學習階段使用

**第 1 週**：DDD 核心概念（Category 1）
- 每天複習 2-3 張
- 重點理解概念本質
- 結合理論章節學習

**第 2 週**：AI 輔助流程（Category 2）
- 實際操作時對照記憶卡
- 記錄自己的提示詞技巧
- 補充自己的經驗

**第 3-4 週**：深入設計技巧（Category 3-5）
- 完成情境題時參考
- 對比自己的設計與卡片
- 總結設計模式

### 複習階段使用

**間隔重複法**：
```
第 1 天：學習新卡片
第 3 天：第一次複習
第 7 天：第二次複習
第 14 天：第三次複習
第 30 天：第四次複習
```

**自我測試**：
- 只看問題，嘗試回答
- 寫下自己的答案
- 對比標準答案
- 標記困難的卡片

---

## 📖 記憶卡範例

### 範例 1：聚合邊界判斷

**【卡片 ID】C3-02**

**【正面】**
```
【情境】
你正在為訂單系統設計領域模型。業務需求：
「訂單提交後，用戶可以修改收貨地址，但修改後需要重新計算運費。」

【問題】
收貨地址（ShippingAddress）應該是：
A. Order 聚合內的值對象
B. Order 聚合內的實體
C. 獨立的聚合根
D. 引用外部地址服務

請選擇並說明理由。
```

**【背面】**
```
【正確答案】A 或 B（取決於業務需求）

【解析】
**如果地址是一次性的** → 值對象（A）
- 修改地址 = 創建新的地址值對象
- 不需要追蹤地址歷史
- 更簡單

**如果需要追蹤地址變更歷史** → 實體（B）
- 地址有 ID，可以追蹤變更
- 可以記錄「誰在什麼時候修改了地址」
- 更複雜但更靈活

**不應該是獨立聚合（C）**：
- 地址與訂單必須保持一致性
- 修改地址 → 運費變化 → 訂單總金額變化
- 必須在同一事務內

**不應該引用外部服務（D）**：
- 訂單的地址是「快照」
- 即使用戶後續修改了地址簿，已下訂單的地址不應變

【關鍵原則】
聚合邊界 = 事務邊界 = 一致性邊界

【記憶點】
「需要原子性更新的，放在一個聚合。」
```

---

### 範例 2：AI 提示詞設計

**【卡片 ID】C2-02**

**【正面】**
```
【情境】
你需要用 AI 進行事件風暴分析，但 AI 生成的事件流程圖缺少異常流程。

【問題】
如何改進提示詞，讓 AI 生成完整的事件風暴圖（包括異常流程）？

請撰寫改進後的提示詞。
```

**【背面】**
```
【改進後的提示詞】

「基於上面的通用語言，請進行事件風暴分析。

【要求】
1. 繪製**完整**的業務流程，包括：
   - 正常流程（happy path）
   - 異常流程（如超時、取消、失敗）
2. 標記每個步驟的觸發者（用戶/系統）
3. 標記每個步驟產生的領域事件
4. 用 Mermaid sequence diagram 表示

【特別關注】
請特別標注以下異常場景：
- 支付超時（30 分鐘未支付）
- 用戶取消訂單
- 支付失敗
- 庫存不足

【輸出格式】
用 Mermaid sequence diagram，用 alt 語法表示異常分支。」

【關鍵技巧】
1. **明確要求異常流程**：「包括異常流程」
2. **列出具體場景**：「支付超時、取消訂單...」
3. **指定輸出格式**：「用 alt 語法」

【記憶點】
「AI 只會做你明確要求的事，不會主動補充。」
```

---

## 🔗 相關資源

- **理論基礎**：[7.1 DDD 核心概念速覽](../理論/7.1_DDD核心概念速覽.md)
- **實踐指南**：[7.2 AI 輔助領域建模](../理論/7.2_AI輔助領域建模.md)
- **情境題庫**：[情境題庫](../情境題庫/)

---

## 📊 複習計畫建議

### 30 天複習計畫

**Week 1（基礎）**：
- Day 1-3：Category 1（DDD 核心概念）
- Day 4-7：Category 2（AI 輔助流程）

**Week 2（進階）**：
- Day 8-10：Category 3（聚合設計）
- Day 11-14：Category 4（值對象與實體）

**Week 3（深入）**：
- Day 15-18：Category 5（領域事件）
- Day 19-21：複習困難卡片

**Week 4（鞏固）**：
- Day 22-24：全部快速過一遍
- Day 25-28：實作情境題時參考
- Day 29-30：總複習

---

## 💡 學習建議

### 給初學者
1. **先理解再記憶**
   - 先完成理論學習（7.1, 7.2）
   - 再開始記憶卡複習

2. **結合實作**
   - 邊做情境題邊複習記憶卡
   - 把記憶卡的知識用到實作中

3. **建立自己的卡片**
   - 遇到新問題時，自己製作記憶卡
   - 記錄自己的經驗與技巧

### 給進階者
1. **挑戰進階卡片**
   - 重點複習進階難度的卡片
   - 思考不同場景的應用

2. **對比多種方案**
   - 同一個問題，思考多種設計方案
   - 分析優缺點與適用場景

3. **補充實戰經驗**
   - 在背面補充自己專案的案例
   - 記錄踩過的坑與解決方案

---

**記憶卡庫版本**：v1.0
**最後更新**：2025-10-30
**卡片總數**：50+ 張（架構）
**完整實現**：2 張範例
