# B01ï¼šè¨‚å–®ç³»çµ± DDD å»ºæ¨¡

## ğŸ“‹ æƒ…å¢ƒèƒŒæ™¯

**å…¬å¸**ï¼šTechMart ç§‘æŠ€é›»å•†
**è§’è‰²**ï¼šå¾Œç«¯é–‹ç™¼å·¥ç¨‹å¸«
**ä»»å‹™**ï¼šç‚ºå…¬å¸çš„è¨‚å–®ç³»çµ±å»ºç«‹ DDD é ˜åŸŸæ¨¡å‹

**æ¥­å‹™ç¾ç‹€**ï¼š
å…¬å¸ç›®å‰çš„è¨‚å–®ç³»çµ±æ˜¯ä¸€å€‹å…¸å‹çš„ CRUD ç³»çµ±ï¼Œéš¨è‘—æ¥­å‹™è¤‡é›œåº¦å¢åŠ ï¼ˆå¤šç¨®æ”¯ä»˜æ–¹å¼ã€è¤‡é›œçš„è¨‚å–®ç‹€æ…‹æµè½‰ã€ä¿ƒéŠ·æ´»å‹•ï¼‰ï¼Œç¾æœ‰çš„è²§è¡€æ¨¡å‹å·²ç¶“é›£ä»¥ç¶­è­·ã€‚æ¥­å‹™é‚è¼¯æ•£è½åœ¨ Service å±¤çš„å„è™•ï¼Œç¶“å¸¸å‡ºç¾ç‹€æ…‹ä¸ä¸€è‡´çš„å•é¡Œã€‚

**æ¥­å‹™ç›®æ¨™**ï¼š
1. é‡æ§‹è¨‚å–®ç³»çµ±ç‚º DDD æ¶æ§‹
2. æ¥­å‹™é‚è¼¯é›†ä¸­åœ¨é ˜åŸŸæ¨¡å‹
3. ç‚ºå¾ŒçºŒå¾®æœå‹™æ‹†åˆ†åšæº–å‚™

---

## ğŸ¯ ä»»å‹™ç›®æ¨™

ä½¿ç”¨ AI è¼”åŠ© DDD å·¥ä½œæµç¨‹ï¼Œå®Œæˆä»¥ä¸‹äº¤ä»˜æˆæœï¼š

- [ ] **éšæ®µ 1**ï¼šé€šç”¨èªè¨€è©å½™è¡¨ï¼ˆMarkdown è¡¨æ ¼ï¼‰
- [ ] **éšæ®µ 2**ï¼šäº‹ä»¶é¢¨æš´åœ–ï¼ˆMermaid æµç¨‹åœ–ï¼‰
- [ ] **éšæ®µ 3**ï¼šé™ç•Œä¸Šä¸‹æ–‡è­˜åˆ¥ï¼ˆæ–‡å­—æè¿° + ä¸Šä¸‹æ–‡åœ°åœ–ï¼‰
- [ ] **éšæ®µ 4**ï¼šè¨‚å–®èšåˆé ˜åŸŸæ¨¡å‹ï¼ˆMermaid é¡åœ– + ç¨‹å¼ç¢¼éª¨æ¶ï¼‰
- [ ] **éšæ®µ 5**ï¼šå®Œæ•´çš„ Python ç¨‹å¼ç¢¼å¯¦ç¾èˆ‡æ¸¬è©¦

**é ä¼°æ™‚é–“**ï¼š45-60 åˆ†é˜

---

## ğŸ“ æ¥­å‹™éœ€æ±‚

### ä½¿ç”¨è€…æ•…äº‹

**Story 1ï¼šè³¼ç‰©è»Šèˆ‡è¨‚å–®æäº¤**
```
ä½œç‚ºä¸€å€‹ç”¨æˆ¶
æˆ‘æƒ³è¦å°‡è³¼ç‰©è»Šçš„å•†å“æäº¤ç‚ºè¨‚å–®
ä»¥ä¾¿æˆ‘å¯ä»¥é€²è¡Œæ”¯ä»˜
```

**Story 2ï¼šè¨‚å–®æ”¯ä»˜**
```
ä½œç‚ºä¸€å€‹ç”¨æˆ¶
æˆ‘æƒ³è¦åœ¨ 30 åˆ†é˜å…§å®Œæˆè¨‚å–®æ”¯ä»˜
å¦å‰‡è¨‚å–®æœƒè¢«è‡ªå‹•é—œé–‰
```

**Story 3ï¼šè¨‚å–®å–æ¶ˆ**
```
ä½œç‚ºä¸€å€‹ç”¨æˆ¶
æˆ‘æƒ³è¦å–æ¶ˆå¾…æ”¯ä»˜æˆ–å·²æ”¯ä»˜çš„è¨‚å–®
å·²æ”¯ä»˜çš„è¨‚å–®å–æ¶ˆå¾Œæœƒè‡ªå‹•é€€æ¬¾
```

**Story 4ï¼šè¨‚å–®å±¥ç´„**
```
ä½œç‚ºç³»çµ±
è¨‚å–®æ”¯ä»˜æˆåŠŸå¾Œæœƒè‡ªå‹•è§¸ç™¼é…è²¨æµç¨‹
é…è²¨å®Œæˆå¾Œè¨‚å–®ç‹€æ…‹è®Šç‚ºã€Œå·²ç™¼è²¨ã€
```

**Story 5ï¼šè¨‚å–®å®Œæˆ**
```
ä½œç‚ºä¸€å€‹ç”¨æˆ¶
æˆ‘æƒ³è¦ç¢ºèªæ”¶è²¨
è¨‚å–®ç‹€æ…‹è®Šç‚ºã€Œå·²å®Œæˆã€å¾Œæœƒç²å¾—ç©åˆ†çå‹µ
```

### æ¥­å‹™æµç¨‹

```
1. ç”¨æˆ¶åœ¨è³¼ç‰©è»ŠåŠ å…¥å•†å“
2. ç”¨æˆ¶æäº¤è¨‚å–®
   â”œâ”€ ç”Ÿæˆè¨‚å–®ç·¨è™Ÿ
   â”œâ”€ é–å®šåº«å­˜
   â””â”€ è¨‚å–®ç‹€æ…‹ = å¾…æ”¯ä»˜

3. ç”¨æˆ¶æ”¯ä»˜è¨‚å–®ï¼ˆ30 åˆ†é˜å…§ï¼‰
   â”œâ”€ æˆåŠŸï¼š
   â”‚   â”œâ”€ è¨‚å–®ç‹€æ…‹ = å·²æ”¯ä»˜
   â”‚   â”œâ”€ è§¸ç™¼é…è²¨
   â”‚   â””â”€ ç™¼é€æ”¯ä»˜æˆåŠŸé€šçŸ¥
   â””â”€ è¶…æ™‚ï¼š
       â”œâ”€ è¨‚å–®ç‹€æ…‹ = å·²é—œé–‰
       â””â”€ é‡‹æ”¾åº«å­˜

4. ç³»çµ±é…è²¨
   â”œâ”€ æº–å‚™å•†å“
   â”œâ”€ è¨‚å–®ç‹€æ…‹ = å·²ç™¼è²¨
   â””â”€ ç™¼é€ç™¼è²¨é€šçŸ¥

5. ç”¨æˆ¶ç¢ºèªæ”¶è²¨
   â”œâ”€ è¨‚å–®ç‹€æ…‹ = å·²å®Œæˆ
   â”œâ”€ å¢åŠ ç”¨æˆ¶ç©åˆ†
   â””â”€ è§¸ç™¼è©•åƒ¹æé†’

ç•°å¸¸æµç¨‹ï¼š
6. ç”¨æˆ¶å–æ¶ˆè¨‚å–®
   â”œâ”€ å¦‚æœæ˜¯å¾…æ”¯ä»˜ï¼š
   â”‚   â”œâ”€ è¨‚å–®ç‹€æ…‹ = å·²å–æ¶ˆ
   â”‚   â””â”€ é‡‹æ”¾åº«å­˜
   â””â”€ å¦‚æœæ˜¯å·²æ”¯ä»˜ï¼š
       â”œâ”€ è¨‚å–®ç‹€æ…‹ = å·²å–æ¶ˆ
       â”œâ”€ é‡‹æ”¾åº«å­˜
       â””â”€ è§¸ç™¼é€€æ¬¾æµç¨‹
```

### æ¥­å‹™è¦å‰‡

| è¦å‰‡ ID | æè¿° |
|---------|------|
| BR-001 | è¨‚å–®æäº¤å¾Œå¿…é ˆåœ¨ 30 åˆ†é˜å…§æ”¯ä»˜ï¼Œå¦å‰‡è‡ªå‹•é—œé–‰ |
| BR-002 | åªæœ‰ã€Œå¾…æ”¯ä»˜ã€å’Œã€Œå·²æ”¯ä»˜ã€ç‹€æ…‹çš„è¨‚å–®å¯ä»¥å–æ¶ˆ |
| BR-003 | å–æ¶ˆã€Œå·²æ”¯ä»˜ã€çš„è¨‚å–®å¿…é ˆé€€æ¬¾ |
| BR-004 | è¨‚å–®é …çš„æ•¸é‡å¿…é ˆå¤§æ–¼ 0 |
| BR-005 | è¨‚å–®ç¸½é‡‘é¡å¿…é ˆå¤§æ–¼ 0 |
| BR-006 | å·²ç™¼è²¨å’Œå·²å®Œæˆçš„è¨‚å–®ä¸èƒ½å–æ¶ˆ |
| BR-007 | è¨‚å–®æäº¤æ™‚å¿…é ˆåŒ…å«è‡³å°‘ä¸€å€‹å•†å“ |

### è¨‚å–®ç‹€æ…‹æµè½‰

```
è‰ç¨¿ï¼ˆDRAFTï¼‰
    â†“ submit()
å¾…æ”¯ä»˜ï¼ˆPENDING_PAYMENTï¼‰
    â†“ mark_as_paid()        â†“ close_if_timeout()    â†“ cancel()
å·²æ”¯ä»˜ï¼ˆPAIDï¼‰              å·²é—œé–‰ï¼ˆCLOSEDï¼‰          å·²å–æ¶ˆï¼ˆCANCELLEDï¼‰
    â†“ mark_as_shipped()
å·²ç™¼è²¨ï¼ˆSHIPPEDï¼‰
    â†“ confirm_receipt()
å·²å®Œæˆï¼ˆCOMPLETEDï¼‰
```

---

## ğŸ”§ æŠ€è¡“è¦æ±‚

- **èªè¨€**ï¼šPython 3.10+
- **åœ–è¡¨å·¥å…·**ï¼šMermaid
- **æ¸¬è©¦æ¡†æ¶**ï¼špytest
- **AI å·¥å…·**ï¼šClaude Code

**ç¨‹å¼ç¢¼è¦æ±‚**ï¼š
- ä½¿ç”¨ dataclass å®šç¾©å€¼å°è±¡
- å€¼å°è±¡å¿…é ˆæ˜¯ä¸å¯è®Šçš„ï¼ˆfrozen=Trueï¼‰
- èšåˆæ ¹å°è£æ‰€æœ‰æ¥­å‹™é‚è¼¯
- ä½¿ç”¨é¡å‹æ¨™è¨»ï¼ˆtype hintsï¼‰

---

## ğŸ“š å­¸ç¿’é‡é»

æœ¬æƒ…å¢ƒè‘—é‡è¨“ç·´ä»¥ä¸‹æŠ€èƒ½ï¼š

1. **å®Œæ•´çš„ AI è¼”åŠ© DDD æµç¨‹**
   - éšæ®µ 1ï¼šé€šç”¨èªè¨€æå–
   - éšæ®µ 2ï¼šäº‹ä»¶é¢¨æš´
   - éšæ®µ 3ï¼šé™ç•Œä¸Šä¸‹æ–‡è­˜åˆ¥
   - éšæ®µ 4ï¼šé ˜åŸŸæ¨¡å‹è¨­è¨ˆ
   - éšæ®µ 5ï¼šç¨‹å¼ç¢¼ç”Ÿæˆ

2. **èšåˆæ ¹è¨­è¨ˆ**
   - å¦‚ä½•å°è£æ¥­å‹™é‚è¼¯
   - å¦‚ä½•ä¿è­·è³‡æ–™ä¸€è‡´æ€§
   - å¦‚ä½•è¨­è¨ˆæ¥­å‹™æ–¹æ³•

3. **å€¼å°è±¡è¨­è¨ˆ**
   - ä½•æ™‚ä½¿ç”¨å€¼å°è±¡
   - å¦‚ä½•è¨­è¨ˆä¸å¯è®Šå€¼å°è±¡
   - å€¼å°è±¡çš„å„ªå‹¢

4. **é ˜åŸŸäº‹ä»¶**
   - å¦‚ä½•è¨­è¨ˆé ˜åŸŸäº‹ä»¶
   - å¦‚ä½•ç™¼å¸ƒèˆ‡è¨‚é–±äº‹ä»¶
   - äº‹ä»¶é©…å‹•çš„è§£è€¦ä½œç”¨

---

## â±ï¸ æ™‚é–“å®‰æ’

| éšæ®µ | ä»»å‹™ | é ä¼°æ™‚é–“ |
|------|------|---------|
| éšæ®µ 1 | é€šç”¨èªè¨€æå– | 10 åˆ†é˜ |
| éšæ®µ 2 | äº‹ä»¶é¢¨æš´ | 10 åˆ†é˜ |
| éšæ®µ 3 | é™ç•Œä¸Šä¸‹æ–‡è­˜åˆ¥ | 5 åˆ†é˜ |
| éšæ®µ 4 | é ˜åŸŸæ¨¡å‹è¨­è¨ˆ | 15 åˆ†é˜ |
| éšæ®µ 5 | ç¨‹å¼ç¢¼ç”Ÿæˆèˆ‡æ¸¬è©¦ | 15 åˆ†é˜ |
| **ç¸½è¨ˆ** | | **55 åˆ†é˜** |

---

## âœ… æª¢æŸ¥é»

### éšæ®µ 1ï¼šé€šç”¨èªè¨€æå–

å®Œæˆå¾Œç¢ºèªï¼š
- [ ] è­˜åˆ¥å‡ºæ ¸å¿ƒé ˜åŸŸæ¦‚å¿µï¼ˆè¨‚å–®ã€è¨‚å–®é …ã€è¨‚å–®ç‹€æ…‹...ï¼‰
- [ ] å€åˆ†å¯¦é«”èˆ‡å€¼å°è±¡
- [ ] åˆ—å‡ºæ‰€æœ‰å‘½ä»¤ï¼ˆsubmit, cancel, mark_as_paid...ï¼‰
- [ ] åˆ—å‡ºæ‰€æœ‰é ˜åŸŸäº‹ä»¶ï¼ˆOrderSubmitted, OrderPaid...ï¼‰
- [ ] æå–æ¥­å‹™è¦å‰‡ï¼ˆ30 åˆ†é˜æ”¯ä»˜è¶…æ™‚...ï¼‰

### éšæ®µ 2ï¼šäº‹ä»¶é¢¨æš´

å®Œæˆå¾Œç¢ºèªï¼š
- [ ] ç¹ªè£½å®Œæ•´çš„æ¥­å‹™æµç¨‹åœ–ï¼ˆåŒ…æ‹¬ç•°å¸¸æµç¨‹ï¼‰
- [ ] æ¨™è¨˜æ¯å€‹æ­¥é©Ÿçš„è§¸ç™¼è€…ï¼ˆç”¨æˆ¶/ç³»çµ±ï¼‰
- [ ] æ¨™è¨˜æ¯å€‹æ­¥é©Ÿç”¢ç”Ÿçš„é ˜åŸŸäº‹ä»¶
- [ ] è­˜åˆ¥å‰¯ä½œç”¨ï¼ˆé–å®šåº«å­˜ã€ç™¼é€é€šçŸ¥...ï¼‰

### éšæ®µ 3ï¼šé™ç•Œä¸Šä¸‹æ–‡è­˜åˆ¥

å®Œæˆå¾Œç¢ºèªï¼š
- [ ] è­˜åˆ¥å‡ºæ ¸å¿ƒä¸Šä¸‹æ–‡ï¼ˆè¨‚å–®ä¸Šä¸‹æ–‡ï¼‰
- [ ] è­˜åˆ¥æ”¯æ’ä¸Šä¸‹æ–‡ï¼ˆæ”¯ä»˜ã€åº«å­˜ã€é…è²¨ã€é€šçŸ¥ï¼‰
- [ ] èªªæ˜ä¸Šä¸‹æ–‡ä¹‹é–“çš„é—œä¿‚ï¼ˆä¸Šæ¸¸/ä¸‹æ¸¸ï¼‰
- [ ] ç¢ºå®šæ•´åˆæ–¹å¼ï¼ˆé ˜åŸŸäº‹ä»¶ï¼‰

### éšæ®µ 4ï¼šé ˜åŸŸæ¨¡å‹è¨­è¨ˆ

å®Œæˆå¾Œç¢ºèªï¼š
- [ ] è¨­è¨ˆ Order èšåˆï¼ˆèšåˆæ ¹ + å¯¦é«” + å€¼å°è±¡ï¼‰
- [ ] è¨­è¨ˆæ‰€æœ‰å€¼å°è±¡ï¼ˆOrderId, OrderStatus, Moneyï¼‰
- [ ] è¨­è¨ˆé ˜åŸŸäº‹ä»¶ï¼ˆOrderSubmitted, OrderPaid, OrderCancelledï¼‰
- [ ] ç¹ªè£½é ˜åŸŸæ¨¡å‹é¡åœ–ï¼ˆMermaidï¼‰

### éšæ®µ 5ï¼šç¨‹å¼ç¢¼ç”Ÿæˆèˆ‡æ¸¬è©¦

å®Œæˆå¾Œç¢ºèªï¼š
- [ ] ç”Ÿæˆå®Œæ•´çš„ Python ç¨‹å¼ç¢¼
- [ ] å¯¦ç¾æ‰€æœ‰æ¥­å‹™æ–¹æ³•ï¼ˆsubmit, cancel, mark_as_paid...ï¼‰
- [ ] æ’°å¯«å–®å…ƒæ¸¬è©¦ï¼ˆè‡³å°‘ 10 å€‹æ¸¬è©¦ç”¨ä¾‹ï¼‰
- [ ] æ¸¬è©¦é€šé

---

## ğŸ’¡ æç¤º

### æç¤º 1ï¼šå¦‚ä½•é–‹å§‹ï¼Ÿ

**ç¬¬ä¸€æ­¥**ï¼šæº–å‚™ AI æç¤ºè©
```
æˆ‘éœ€è¦ç‚ºé›»å•†è¨‚å–®ç³»çµ±å»ºç«‹ DDD é ˜åŸŸæ¨¡å‹ã€‚
è«‹å¾ä»¥ä¸‹æ¥­å‹™éœ€æ±‚ä¸­æå–é€šç”¨èªè¨€ï¼ˆUbiquitous Languageï¼‰ã€‚

ã€æ¥­å‹™éœ€æ±‚ã€‘
[è²¼ä¸Šä¸Šé¢çš„æ¥­å‹™éœ€æ±‚]

ã€è¦æ±‚ã€‘
1. è­˜åˆ¥æ ¸å¿ƒé ˜åŸŸæ¦‚å¿µï¼ˆåè©ï¼‰
2. è­˜åˆ¥é—œéµæ¥­å‹™è¡Œç‚ºï¼ˆå‹•è©ï¼‰
3. è­˜åˆ¥é ˜åŸŸäº‹ä»¶ï¼ˆéå»å¼å‹•è©ï¼‰
4. è­˜åˆ¥æ¥­å‹™è¦å‰‡èˆ‡ç´„æŸ
5. ç”¨è¡¨æ ¼å½¢å¼è¼¸å‡º
```

### æç¤º 2ï¼šå¦‚ä½•ç¹ªè£½äº‹ä»¶é¢¨æš´åœ–ï¼Ÿ

**æç¤ºè©ç¯„ä¾‹**ï¼š
```
åŸºæ–¼ä¸Šé¢çš„é€šç”¨èªè¨€ï¼Œè«‹é€²è¡Œäº‹ä»¶é¢¨æš´åˆ†æã€‚

ã€è¦æ±‚ã€‘
1. ç¹ªè£½å®Œæ•´çš„æ¥­å‹™æµç¨‹ï¼ˆåŒ…æ‹¬ç•°å¸¸æµç¨‹ï¼‰
2. æ¨™è¨˜è§¸ç™¼è€…ï¼ˆç”¨æˆ¶/ç³»çµ±ï¼‰
3. æ¨™è¨˜é ˜åŸŸäº‹ä»¶
4. ç”¨ Mermaid sequence diagram è¡¨ç¤º
```

### æç¤º 3ï¼šå¦‚ä½•è¨­è¨ˆèšåˆé‚Šç•Œï¼Ÿ

**æ€è€ƒå•é¡Œ**ï¼š
- å“ªäº›å¯¦é«”å¿…é ˆä¿æŒä¸€è‡´æ€§ï¼Ÿâ†’ æ‡‰è©²åœ¨åŒä¸€å€‹èšåˆ
- å“ªäº›å¯¦é«”å¯ä»¥æœ€çµ‚ä¸€è‡´æ€§ï¼Ÿâ†’ å¯ä»¥åˆ†é›¢åˆ°ä¸åŒèšåˆ
- å“ªäº›æ“ä½œéœ€è¦åŸå­æ€§ï¼Ÿâ†’ åœ¨èšåˆæ ¹ä¸Šæä¾›æ–¹æ³•

**è¨‚å–®ç³»çµ±çš„èšåˆè¨­è¨ˆ**ï¼š
```
Order èšåˆåŒ…å«ï¼š
âœ… Orderï¼ˆèšåˆæ ¹ï¼‰
âœ… OrderItemï¼ˆå…§éƒ¨å¯¦é«”ï¼‰- å› ç‚ºè¨‚å–®é …èˆ‡è¨‚å–®å¿…é ˆä¿æŒä¸€è‡´

Order èšåˆä¸åŒ…å«ï¼š
âŒ Paymentï¼ˆæ”¯ä»˜ï¼‰- å¯ä»¥æœ€çµ‚ä¸€è‡´æ€§ï¼Œç¨ç«‹èšåˆ
âŒ Shipmentï¼ˆé…è²¨ï¼‰- å¯ä»¥æœ€çµ‚ä¸€è‡´æ€§ï¼Œç¨ç«‹èšåˆ
âŒ Customerï¼ˆç”¨æˆ¶ï¼‰- å¼•ç”¨ç”¨æˆ¶ IDï¼Œä¸ç›´æ¥åŒ…å«
```

### æç¤º 4ï¼šå¦‚ä½•è¨­è¨ˆå€¼å°è±¡ï¼Ÿ

**åˆ¤æ–·æ¨™æº–**ï¼š
```
å•é¡Œï¼šå…©å€‹å±¬æ€§å®Œå…¨ç›¸åŒçš„ç‰©ä»¶ï¼Œæ˜¯åŒä¸€å€‹å—ï¼Ÿ

å¦‚æœæ˜¯ â†’ å€¼å°è±¡ï¼ˆä¾‹å¦‚ï¼š100 å…ƒå°±æ˜¯ 100 å…ƒï¼‰
å¦‚æœä¸æ˜¯ â†’ å¯¦é«”ï¼ˆä¾‹å¦‚ï¼šå…©å€‹è¨‚å–®é‡‘é¡ç›¸åŒï¼Œä½†ä¸æ˜¯åŒä¸€å€‹è¨‚å–®ï¼‰
```

**è¨‚å–®ç³»çµ±çš„å€¼å°è±¡**ï¼š
- OrderIdï¼ˆè¨‚å–® IDï¼‰
- Moneyï¼ˆé‡‘é¡ï¼‰
- OrderStatusï¼ˆè¨‚å–®ç‹€æ…‹ï¼‰

### æç¤º 5ï¼šé‡åˆ°å›°é›£æ€éº¼è¾¦ï¼Ÿ

1. **AI è¼¸å‡ºä¸ç†æƒ³**ï¼š
   - è£œå……æ›´è©³ç´°çš„æ¥­å‹™æè¿°
   - æ˜ç¢ºå‘Šè¨´ AI å“ªè£¡ä¸å°
   - è¦æ±‚ AI ç”Ÿæˆå¤šå€‹æ–¹æ¡ˆ

2. **ä¸çŸ¥é“å¦‚ä½•åŠƒåˆ†èšåˆ**ï¼š
   - å…ˆå…¨éƒ¨æ”¾åœ¨ä¸€å€‹èšåˆ
   - ç™¼ç¾å•é¡Œå¾Œå†æ‹†åˆ†
   - åƒè€ƒåƒè€ƒè§£ç­”

3. **ç¨‹å¼ç¢¼æœ‰å•é¡Œ**ï¼š
   - æª¢æŸ¥æ˜¯å¦å¯¦ç¾äº†æ‰€æœ‰æ¥­å‹™è¦å‰‡
   - åŸ·è¡Œæ¸¬è©¦æ‰¾å‡ºå•é¡Œ
   - åƒè€ƒåƒè€ƒè§£ç­”çš„å¯¦ç¾

---

## ğŸ“– åƒè€ƒè§£ç­”

### éšæ®µ 1ï¼šé€šç”¨èªè¨€è©å½™è¡¨

#### æ ¸å¿ƒé ˜åŸŸæ¦‚å¿µ

| è¡“èª | è‹±æ–‡ | é¡å‹ | å®šç¾© |
|------|------|------|------|
| è¨‚å–® | Order | èšåˆæ ¹ | ç”¨æˆ¶çš„è³¼è²·è«‹æ±‚ |
| è¨‚å–®é … | OrderItem | å¯¦é«” | è¨‚å–®å…§çš„å–®å€‹å•†å“é … |
| è¨‚å–®ç‹€æ…‹ | OrderStatus | å€¼å°è±¡ï¼ˆæšèˆ‰ï¼‰ | è¨‚å–®ç•¶å‰ç‹€æ…‹ |
| è¨‚å–® ID | OrderId | å€¼å°è±¡ | è¨‚å–®å”¯ä¸€è­˜åˆ¥ç¢¼ |
| é‡‘é¡ | Money | å€¼å°è±¡ | é‡‘é¡èˆ‡å¹£ç¨® |
| ç”¨æˆ¶ ID | CustomerId | å€¼å°è±¡ | ç”¨æˆ¶å¼•ç”¨ |
| å•†å“ ID | ProductId | å€¼å°è±¡ | å•†å“å¼•ç”¨ |

#### è¨‚å–®ç‹€æ…‹

| ç‹€æ…‹ | è‹±æ–‡ | èªªæ˜ |
|------|------|------|
| è‰ç¨¿ | DRAFT | è¨‚å–®å‰µå»ºä½†æœªæäº¤ |
| å¾…æ”¯ä»˜ | PENDING_PAYMENT | è¨‚å–®å·²æäº¤ï¼Œç­‰å¾…æ”¯ä»˜ |
| å·²æ”¯ä»˜ | PAID | è¨‚å–®å·²æ”¯ä»˜æˆåŠŸ |
| å·²ç™¼è²¨ | SHIPPED | è¨‚å–®å·²ç™¼è²¨ |
| å·²å®Œæˆ | COMPLETED | ç”¨æˆ¶å·²ç¢ºèªæ”¶è²¨ |
| å·²å–æ¶ˆ | CANCELLED | è¨‚å–®å·²å–æ¶ˆ |
| å·²é—œé–‰ | CLOSED | è¶…æ™‚æœªæ”¯ä»˜è‡ªå‹•é—œé–‰ |

#### å‘½ä»¤ï¼ˆæ¥­å‹™è¡Œç‚ºï¼‰

| å‘½ä»¤ | è‹±æ–‡ | è§¸ç™¼è€… | å®šç¾© |
|------|------|--------|------|
| æ–°å¢è¨‚å–®é … | add_item | ç”¨æˆ¶ | å°‡å•†å“åŠ å…¥è¨‚å–® |
| ç§»é™¤è¨‚å–®é … | remove_item | ç”¨æˆ¶ | å¾è¨‚å–®ç§»é™¤å•†å“ |
| æäº¤è¨‚å–® | submit | ç”¨æˆ¶ | æäº¤è¨‚å–®é€²å…¥å¾…æ”¯ä»˜ |
| æ¨™è¨˜å·²æ”¯ä»˜ | mark_as_paid | ç³»çµ± | æ¨™è¨˜è¨‚å–®ç‚ºå·²æ”¯ä»˜ |
| å–æ¶ˆè¨‚å–® | cancel | ç”¨æˆ¶ | å–æ¶ˆè¨‚å–® |
| é—œé–‰è¨‚å–® | close_if_timeout | ç³»çµ± | è¶…æ™‚è‡ªå‹•é—œé–‰ |
| æ¨™è¨˜å·²ç™¼è²¨ | mark_as_shipped | ç³»çµ± | æ¨™è¨˜è¨‚å–®ç‚ºå·²ç™¼è²¨ |
| ç¢ºèªæ”¶è²¨ | confirm_receipt | ç”¨æˆ¶ | ç¢ºèªæ”¶åˆ°å•†å“ |

#### é ˜åŸŸäº‹ä»¶

| äº‹ä»¶ | è‹±æ–‡ | è§¸ç™¼æ™‚æ©Ÿ | è¨‚é–±è€… |
|------|------|---------|--------|
| è¨‚å–®å·²æäº¤ | OrderSubmitted | ç”¨æˆ¶æäº¤è¨‚å–® | åº«å­˜ç³»çµ± |
| è¨‚å–®å·²æ”¯ä»˜ | OrderPaid | è¨‚å–®æ”¯ä»˜æˆåŠŸ | é…è²¨ç³»çµ±ã€é€šçŸ¥ç³»çµ± |
| è¨‚å–®å·²å–æ¶ˆ | OrderCancelled | è¨‚å–®è¢«å–æ¶ˆ | åº«å­˜ç³»çµ±ã€æ”¯ä»˜ç³»çµ± |
| è¨‚å–®å·²é—œé–‰ | OrderClosed | è¨‚å–®è¶…æ™‚é—œé–‰ | åº«å­˜ç³»çµ± |
| è¨‚å–®å·²ç™¼è²¨ | OrderShipped | è¨‚å–®ç™¼è²¨ | é€šçŸ¥ç³»çµ± |
| è¨‚å–®å·²å®Œæˆ | OrderCompleted | ç”¨æˆ¶ç¢ºèªæ”¶è²¨ | ç©åˆ†ç³»çµ±ã€è©•åƒ¹ç³»çµ± |

---

### éšæ®µ 2ï¼šäº‹ä»¶é¢¨æš´åœ–

```mermaid
sequenceDiagram
    actor User as ç”¨æˆ¶
    participant Order as è¨‚å–®èšåˆ
    participant Inventory as åº«å­˜ç³»çµ±
    participant Payment as æ”¯ä»˜ç³»çµ±
    participant Shipping as é…è²¨ç³»çµ±
    participant Notification as é€šçŸ¥ç³»çµ±

    %% æäº¤è¨‚å–®
    User->>Order: submit()
    activate Order
    Order->>Order: ç”Ÿæˆè¨‚å–®ç·¨è™Ÿ
    Order->>Order: ç‹€æ…‹ = PENDING_PAYMENT
    Order->>Inventory: OrderSubmitted äº‹ä»¶
    Inventory->>Inventory: é–å®šåº«å­˜
    Order-->>User: è¿”å›è¨‚å–®ç·¨è™Ÿ
    deactivate Order
    Note over Order: è¨‚å–®å·²æäº¤ï¼ˆå¾…æ”¯ä»˜ï¼‰

    %% æ”¯ä»˜æˆåŠŸ
    User->>Payment: æ”¯ä»˜è¨‚å–®
    Payment->>Order: mark_as_paid()
    activate Order
    Order->>Order: ç‹€æ…‹ = PAID
    Order->>Shipping: OrderPaid äº‹ä»¶
    Order->>Notification: OrderPaid äº‹ä»¶
    Shipping->>Shipping: æº–å‚™é…è²¨
    Notification->>User: ç™¼é€æ”¯ä»˜æˆåŠŸé€šçŸ¥
    deactivate Order
    Note over Order: è¨‚å–®å·²æ”¯ä»˜

    %% è¶…æ™‚é—œé–‰
    alt 30åˆ†é˜å…§æœªæ”¯ä»˜
        Order->>Order: close_if_timeout()
        Order->>Order: ç‹€æ…‹ = CLOSED
        Order->>Inventory: OrderClosed äº‹ä»¶
        Inventory->>Inventory: é‡‹æ”¾åº«å­˜
        Note over Order: è¨‚å–®å·²é—œé–‰
    end

    %% é…è²¨èˆ‡ç™¼è²¨
    Shipping->>Order: mark_as_shipped()
    activate Order
    Order->>Order: ç‹€æ…‹ = SHIPPED
    Order->>Notification: OrderShipped äº‹ä»¶
    Notification->>User: ç™¼é€ç™¼è²¨é€šçŸ¥
    deactivate Order
    Note over Order: è¨‚å–®å·²ç™¼è²¨

    %% ç¢ºèªæ”¶è²¨
    User->>Order: confirm_receipt()
    activate Order
    Order->>Order: ç‹€æ…‹ = COMPLETED
    Order->>Notification: OrderCompleted äº‹ä»¶
    deactivate Order
    Note over Order: è¨‚å–®å·²å®Œæˆ

    %% å–æ¶ˆè¨‚å–®
    alt ç”¨æˆ¶å–æ¶ˆè¨‚å–®
        User->>Order: cancel()
        Order->>Order: ç‹€æ…‹ = CANCELLED
        Order->>Inventory: OrderCancelled äº‹ä»¶
        Inventory->>Inventory: é‡‹æ”¾åº«å­˜
        alt å·²æ”¯ä»˜
            Order->>Payment: OrderCancelled äº‹ä»¶
            Payment->>Payment: è§¸ç™¼é€€æ¬¾
        end
        Note over Order: è¨‚å–®å·²å–æ¶ˆ
    end
```

---

### éšæ®µ 3ï¼šé™ç•Œä¸Šä¸‹æ–‡è­˜åˆ¥

#### ä¸Šä¸‹æ–‡åŠƒåˆ†

æœ¬å ´æ™¯èšç„¦æ–¼**è¨‚å–®ä¸Šä¸‹æ–‡ï¼ˆOrder Contextï¼‰**ï¼Œå…¶ä»–ä¸Šä¸‹æ–‡åœ¨å¯¦éš›å°ˆæ¡ˆä¸­æ˜¯ç¨ç«‹çš„é™ç•Œä¸Šä¸‹æ–‡ï¼š

- **è¨‚å–®ä¸Šä¸‹æ–‡**ï¼ˆæœ¬æ¬¡å»ºæ¨¡é‡é»ï¼‰ï¼šç®¡ç†è¨‚å–®ç”Ÿå‘½é€±æœŸ
- **æ”¯ä»˜ä¸Šä¸‹æ–‡**ï¼šè™•ç†æ”¯ä»˜èˆ‡é€€æ¬¾ï¼ˆé€šéäº‹ä»¶æ•´åˆï¼‰
- **åº«å­˜ä¸Šä¸‹æ–‡**ï¼šç®¡ç†å•†å“åº«å­˜ï¼ˆé€šéäº‹ä»¶æ•´åˆï¼‰
- **é…è²¨ä¸Šä¸‹æ–‡**ï¼šè™•ç†é…è²¨èˆ‡ç‰©æµï¼ˆé€šéäº‹ä»¶æ•´åˆï¼‰
- **é€šçŸ¥ä¸Šä¸‹æ–‡**ï¼šç™¼é€å„é¡é€šçŸ¥ï¼ˆé€šéäº‹ä»¶æ•´åˆï¼‰

#### ä¸Šä¸‹æ–‡é—œä¿‚

```
è¨‚å–®ä¸Šä¸‹æ–‡ï¼ˆæ ¸å¿ƒåŸŸï¼‰
    â†“ ç™¼å¸ƒäº‹ä»¶
â”œâ”€ æ”¯ä»˜ä¸Šä¸‹æ–‡ï¼ˆè¨‚é–± OrderPaid, OrderCancelledï¼‰
â”œâ”€ åº«å­˜ä¸Šä¸‹æ–‡ï¼ˆè¨‚é–± OrderSubmitted, OrderCancelled, OrderClosedï¼‰
â”œâ”€ é…è²¨ä¸Šä¸‹æ–‡ï¼ˆè¨‚é–± OrderPaidï¼‰
â””â”€ é€šçŸ¥ä¸Šä¸‹æ–‡ï¼ˆè¨‚é–±æ‰€æœ‰äº‹ä»¶ï¼‰
```

---

### éšæ®µ 4ï¼šé ˜åŸŸæ¨¡å‹è¨­è¨ˆ

#### é ˜åŸŸæ¨¡å‹é¡åœ–

```mermaid
classDiagram
    class Order {
        <<AggregateRoot>>
        -OrderId id
        -str customer_id
        -OrderStatus status
        -List~OrderItem~ items
        -datetime payment_deadline
        -datetime created_at
        -datetime paid_at
        -List~DomainEvent~ _events
        +add_item(product_id, name, quantity, price)
        +remove_item(product_id)
        +submit()
        +mark_as_paid()
        +cancel(reason)
        +close_if_timeout()
        +confirm_receipt()
        +can_be_cancelled() bool
        +total_amount() Money
        +get_events() List
    }

    class OrderItem {
        <<Entity>>
        -str product_id
        -str product_name
        -int quantity
        -Money unit_price
        +subtotal() Money
        +change_quantity(new_quantity)
    }

    class OrderId {
        <<ValueObject>>
        -str value
        +of(value) OrderId$
        +generate() OrderId$
    }

    class OrderStatus {
        <<ValueObject>>
        <<Enumeration>>
        DRAFT
        PENDING_PAYMENT
        PAID
        SHIPPED
        COMPLETED
        CANCELLED
        CLOSED
    }

    class Money {
        <<ValueObject>>
        -Decimal amount
        -str currency
        +add(other) Money
        +multiply(multiplier) Money
    }

    class OrderSubmittedEvent {
        <<DomainEvent>>
        +OrderId order_id
        +str customer_id
        +List items
        +datetime occurred_at
    }

    class OrderPaidEvent {
        <<DomainEvent>>
        +OrderId order_id
        +Money total_amount
        +datetime paid_at
    }

    class OrderCancelledEvent {
        <<DomainEvent>>
        +OrderId order_id
        +str reason
        +datetime cancelled_at
    }

    Order "1" *-- "many" OrderItem
    Order --> OrderId
    Order --> OrderStatus
    Order --> Money
    OrderItem --> Money
    Order ..> OrderSubmittedEvent : emits
    Order ..> OrderPaidEvent : emits
    Order ..> OrderCancelledEvent : emits
```

---

### éšæ®µ 5ï¼šPython ç¨‹å¼ç¢¼å¯¦ç¾

ç”±æ–¼ç¯‡å¹…é™åˆ¶ï¼Œé€™è£¡æä¾›æ ¸å¿ƒç¨‹å¼ç¢¼ç‰‡æ®µã€‚å®Œæ•´ç¨‹å¼ç¢¼è«‹åƒè€ƒ `ç¯„ä¾‹æ¨¡å‹/è¨‚å–®ç³»çµ±/`ã€‚

**å€¼å°è±¡**ï¼ˆvalue_objects.pyï¼‰ï¼š
```python
from dataclasses import dataclass
from decimal import Decimal
from enum import Enum
import uuid

@dataclass(frozen=True)
class OrderId:
    value: str

    @staticmethod
    def generate() -> 'OrderId':
        return OrderId(f"ORD-{uuid.uuid4().hex[:12].upper()}")

@dataclass(frozen=True)
class Money:
    amount: Decimal
    currency: str = "USD"

    def __add__(self, other: 'Money') -> 'Money':
        if self.currency != other.currency:
            raise ValueError("å¹£ç¨®ä¸ä¸€è‡´")
        return Money(self.amount + other.amount, self.currency)

    def __mul__(self, multiplier: int) -> 'Money':
        return Money(self.amount * multiplier, self.currency)

class OrderStatus(Enum):
    DRAFT = "draft"
    PENDING_PAYMENT = "pending_payment"
    PAID = "paid"
    SHIPPED = "shipped"
    COMPLETED = "completed"
    CANCELLED = "cancelled"
    CLOSED = "closed"
```

**èšåˆæ ¹**ï¼ˆorder.pyï¼‰ï¼š
```python
from typing import List, Optional
from datetime import datetime, timedelta

class Order:
    """è¨‚å–®èšåˆæ ¹"""

    def __init__(self, order_id: OrderId, customer_id: str):
        self.id = order_id
        self.customer_id = customer_id
        self.status = OrderStatus.DRAFT
        self.items: List[OrderItem] = []
        self.payment_deadline: Optional[datetime] = None
        self.created_at = datetime.now()
        self._events: List = []

    def submit(self):
        """æäº¤è¨‚å–®"""
        if self.status != OrderStatus.DRAFT:
            raise InvalidOrderStateError("åªæœ‰è‰ç¨¿ç‹€æ…‹æ‰èƒ½æäº¤")
        if not self.items:
            raise ValueError("è¨‚å–®å¿…é ˆåŒ…å«è‡³å°‘ä¸€å€‹å•†å“")

        self.status = OrderStatus.PENDING_PAYMENT
        self.payment_deadline = datetime.now() + timedelta(minutes=30)

        self._events.append(OrderSubmittedEvent(
            order_id=self.id,
            customer_id=self.customer_id,
            items=[{'product_id': i.product_id, 'quantity': i.quantity}
                   for i in self.items],
            occurred_at=datetime.now()
        ))

    def mark_as_paid(self):
        """æ¨™è¨˜ç‚ºå·²æ”¯ä»˜"""
        if self.status != OrderStatus.PENDING_PAYMENT:
            raise InvalidOrderStateError("åªæœ‰å¾…æ”¯ä»˜è¨‚å–®æ‰èƒ½æ¨™è¨˜ç‚ºå·²æ”¯ä»˜")

        self.status = OrderStatus.PAID
        self.paid_at = datetime.now()

        self._events.append(OrderPaidEvent(
            order_id=self.id,
            total_amount=self.total_amount,
            paid_at=self.paid_at
        ))

    @property
    def total_amount(self) -> Money:
        """è¨ˆç®—ç¸½é‡‘é¡"""
        if not self.items:
            return Money(Decimal(0))
        return sum((item.subtotal for item in self.items), Money(Decimal(0)))
```

**æ¸¬è©¦**ï¼ˆtest_order.pyï¼‰ï¼š
```python
import pytest
from decimal import Decimal

def test_submit_order():
    order = Order(OrderId.generate(), "CUST001")
    order.add_item("PROD001", "iPhone", 1, Money(Decimal("999.99")))
    order.submit()

    assert order.status == OrderStatus.PENDING_PAYMENT
    assert len(order.get_events()) == 1

def test_mark_as_paid():
    order = create_pending_order()
    order.mark_as_paid()

    assert order.status == OrderStatus.PAID
    assert order.paid_at is not None
```

---

## ğŸ¤” åæ€å•é¡Œ

å®Œæˆç·´ç¿’å¾Œï¼Œæ€è€ƒä»¥ä¸‹å•é¡Œï¼š

1. **èšåˆé‚Šç•Œ**ï¼š
   - ç‚ºä»€éº¼ OrderItem æ‡‰è©²åœ¨ Order èšåˆå…§ï¼Œè€Œ Payment æ‡‰è©²æ˜¯ç¨ç«‹èšåˆï¼Ÿ
   - å¦‚æœæ¥­å‹™éœ€æ±‚è®Šæ›´ï¼Œéœ€è¦è¿½è¹¤æ¯æ¬¡è¨‚å–®é …æ•¸é‡è®Šæ›´çš„æ­·å²ï¼Œèšåˆè¨­è¨ˆæ‡‰è©²å¦‚ä½•èª¿æ•´ï¼Ÿ

2. **å€¼å°è±¡è¨­è¨ˆ**ï¼š
   - Money ç‚ºä»€éº¼è¨­è¨ˆç‚ºä¸å¯è®Šï¼ˆfrozen=Trueï¼‰ï¼Ÿ
   - å¦‚æœéœ€è¦æ”¯æ´å¤šå¹£ç¨®è½‰æ›ï¼ŒMoney æ‡‰è©²å¦‚ä½•è¨­è¨ˆï¼Ÿ

3. **é ˜åŸŸäº‹ä»¶**ï¼š
   - ç‚ºä»€éº¼ä½¿ç”¨é ˜åŸŸäº‹ä»¶è€Œä¸æ˜¯ç›´æ¥èª¿ç”¨å…¶ä»–ç³»çµ±çš„ APIï¼Ÿ
   - å¦‚æœäº‹ä»¶è™•ç†å¤±æ•—ï¼ˆå¦‚åº«å­˜æ‰£æ¸›å¤±æ•—ï¼‰ï¼Œæ‡‰è©²å¦‚ä½•è™•ç†ï¼Ÿ

4. **æ¥­å‹™è¦å‰‡**ï¼š
   - 30 åˆ†é˜æ”¯ä»˜è¶…æ™‚çš„é‚è¼¯æ‡‰è©²æ”¾åœ¨å“ªè£¡ï¼Ÿï¼ˆè¨‚å–®èšåˆï¼Ÿå®šæ™‚ä»»å‹™ï¼Ÿï¼‰
   - å¦‚æœæ¥­å‹™è¦å‰‡é »ç¹è®Šæ›´ï¼ˆå¦‚ VIP ç”¨æˆ¶ 60 åˆ†é˜è¶…æ™‚ï¼‰ï¼Œå¦‚ä½•è¨­è¨ˆæ›´éˆæ´»çš„æ¨¡å‹ï¼Ÿ

5. **AI è¼”åŠ©**ï¼š
   - AI åœ¨å“ªäº›éšæ®µå¹«åŠ©æœ€å¤§ï¼Ÿå“ªäº›éšæ®µä»éœ€è¦å¤§é‡äººå·¥åˆ¤æ–·ï¼Ÿ
   - å¦‚æœè®“ä½ å‘åœ˜éšŠæ¨å»£ AI è¼”åŠ© DDDï¼Œä½ æœƒå¼·èª¿å“ªäº›å„ªå‹¢ï¼Ÿ

---

## ğŸ“ ç¸½çµ

**å®Œæˆæœ¬æƒ…å¢ƒå¾Œï¼Œä½ æ‡‰è©²èƒ½å¤ **ï¼š
- âœ… ç¨ç«‹ä½¿ç”¨ AI å®Œæˆ DDD å»ºæ¨¡çš„ 5 å€‹éšæ®µ
- âœ… è¨­è¨ˆåˆç†çš„èšåˆé‚Šç•Œ
- âœ… å¯¦ç¾å……è¡€çš„é ˜åŸŸæ¨¡å‹ï¼ˆæ¥­å‹™é‚è¼¯å°è£åœ¨èšåˆæ ¹ï¼‰
- âœ… ä½¿ç”¨é ˜åŸŸäº‹ä»¶è§£è€¦ç³»çµ±

**ä¸‹ä¸€æ­¥**ï¼š
- å˜—è©¦å…¶ä»–åŸºç¤ç´šæƒ…å¢ƒï¼ˆB02-B04ï¼‰
- æŒ‘æˆ°çµ„åˆç´šæƒ…å¢ƒï¼ˆå¤šå€‹ä¸Šä¸‹æ–‡ï¼‰
- å°‡ DDD æ‡‰ç”¨åˆ°ä½ è‡ªå·±çš„å°ˆæ¡ˆ

---

**æƒ…å¢ƒç‰ˆæœ¬**ï¼šv1.0
**é›£åº¦ç´šåˆ¥**ï¼šåŸºç¤ç´š
**é ä¼°æ™‚é–“**ï¼š45-60 åˆ†é˜
