# 3.3 工具選擇決策樹

## 📋 學習目標

完成本章後，你將能夠：

- ✅ 使用決策矩陣快速選擇工具
- ✅ 為任意場景設計混合工具鏈
- ✅ 評估工具選擇的成本效益
- ✅ 理解工具之間的互補關係
- ✅ 為團隊設計工具採購策略

**預計時間**：10 分鐘

---

## 🎯 核心決策矩陣

### 快速決策表

| 場景特徵 | 首選工具 | 次選工具 | 理由 |
|---------|---------|---------|------|
| **檔案數量 < 10** | Copilot | Claude Code | 即時補全最快 |
| **檔案數量 10-50** | Claude Code | Copilot | 需要跨檔案理解 |
| **檔案數量 > 50** | Gemini CLI | Claude Code | 需要全局視野 |
| **單一函數/類別** | Copilot | - | IDE 內操作最方便 |
| **跨檔案重構** | Claude Code | - | 工作流程編排 |
| **架構分析** | Gemini CLI | Claude Code | 巨量上下文優勢 |
| **測試生成** | Copilot | Claude Code | 模式識別能力強 |
| **安全審查** | Claude Code | - | 需要深度分析 |
| **文檔生成** | Claude Code | - | 格式控制能力 |
| **日常編碼** | Copilot | - | 持續使用不干擾 |
| **知識工作** | Claude Code | - | 超越編程能力 |

---

## 🌳 完整決策樹

### 主決策樹

```
開始：你需要做什麼？
│
├─ 📝 寫程式碼（單個函數、類別）
│  │
│  ├─ 檔案 < 5 個 → Copilot（即時補全）
│  ├─ 檔案 5-20 個 → Copilot + Claude Code（審查）
│  └─ 檔案 > 20 個 → Claude Code（工作流程）
│
├─ 🔧 重構程式碼
│  │
│  ├─ 單一檔案小調整 → Copilot
│  ├─ 跨檔案重構（<30 檔案）→ Claude Code
│  ├─ 大規模重構（>30 檔案）→ Gemini CLI（規劃）+ Claude Code（執行）
│  └─ 架構級重構 → Gemini CLI（全局分析）→ Claude Code（實施）
│
├─ 🔍 理解程式碼
│  │
│  ├─ 理解單一函數 → Copilot（查看建議）
│  ├─ 理解模組（<30 檔案）→ Claude Code
│  ├─ 理解大型專案（>50 檔案）→ Gemini CLI
│  └─ 新人 Onboarding → Gemini CLI（Day 1）→ Claude Code（日常）
│
├─ 🧪 測試相關
│  │
│  ├─ 單元測試生成 → Copilot（快速）
│  ├─ 整合測試設計 → Claude Code（複雜邏輯）
│  ├─ TDD 流程 → Claude Code（/agents:test-generator）
│  └─ 測試覆蓋分析 → Claude Code
│
├─ 🔒 安全與品質
│  │
│  ├─ 快速安全檢查 → Copilot（基本建議）
│  ├─ 深度安全審查 → Claude Code（/agents:security-auditor）
│  ├─ 程式碼品質審查 → Claude Code（/agents:code-reviewer）
│  └─ 全局安全分析 → Gemini CLI（找出所有風險點）
│
├─ 📚 文檔與知識
│  │
│  ├─ 函數註解 → Copilot
│  ├─ API 文檔 → Claude Code（/output-style:api-docs）
│  ├─ 技術文章 → Claude Code（知識工作能力）
│  └─ 架構文檔 → Gemini CLI（分析）+ Claude Code（撰寫）
│
└─ 🤔 不確定？
   └─ 使用「三個問題法」（見下方）
```

---

## 💡 三個問題法

當不確定選擇哪個工具時，問自己三個問題：

### 問題 1：任務的「廣度」？

```
單一檔案        → Copilot
幾個檔案（<10） → Copilot + Claude Code
一個模組（<30） → Claude Code
整個專案（>50） → Gemini CLI
```

### 問題 2：需要「執行」還是「分析」？

```
只需要分析、理解 → Gemini CLI（僅分析）
需要修改程式碼   → Claude Code（可執行）
需要即時補全     → Copilot（即時）
```

### 問題 3：「頻率」多高？

```
持續使用（每分鐘） → Copilot（不干擾工作流程）
偶爾使用（每小時） → Claude Code（對話式）
極少使用（每週）   → Gemini CLI（一次性分析）
```

---

## 🎭 混合工作流程設計

### 模式 1：日常開發流程

```
場景：開發新功能

9:00 - 用 Copilot 快速寫程式碼（30 分鐘）
├─ 建立 API 端點
├─ 撰寫業務邏輯
└─ 生成測試案例

9:30 - 用 Claude Code 審查（10 分鐘）
├─ /agents:security-auditor → 檢查安全問題
├─ /agents:code-reviewer → 檢查程式碼品質
└─ 修正發現的問題

9:40 - 用 Copilot 完成修正（10 分鐘）
└─ 快速修改 Copilot 建議的問題

9:50 - 用 Claude Code 生成文檔（10 分鐘）
└─ /output-style:api-docs
└─ 自動生成 API 文檔

總計：1 小時完成高品質功能
```

**工具佔比**：
- Copilot: 60%（編碼時間）
- Claude Code: 40%（審查與文檔）
- Gemini CLI: 0%（不需要）

---

### 模式 2：大型重構流程

```
場景：重構 Monolith 為 Microservices

Week 1: 規劃階段
├─ Day 1: 用 Gemini CLI 全局分析（2 小時）
│   └─ 載入所有程式碼（500 檔案）
│   └─ 分析模組依賴關係
│   └─ 識別可拆分的模組
│   └─ 評估風險
│
└─ Day 2-5: 用 Claude Code 設計（3 天）
    └─ 設計拆分計畫
    └─ 建立新專案結構
    └─ 撰寫遷移文檔

Week 2-4: 執行階段
├─ 用 Claude Code 主力重構（每天 4 小時）
│   └─ /agents:refactoring-specialist
│   └─ 批量修改程式碼
│   └─ 更新 import 路徑
│
└─ 用 Copilot 輔助（每天 4 小時）
    └─ 快速建立新檔案
    └─ 生成適配程式碼
    └─ 補充測試案例

總計：4 週完成重構
```

**工具佔比**：
- Gemini CLI: 5%（初期規劃）
- Claude Code: 65%（主力重構）
- Copilot: 30%（輔助編碼）

---

### 模式 3：新人 Onboarding 流程

```
場景：新工程師加入團隊

Day 1: 理解專案
├─ 用 Gemini CLI 全局分析（1 小時）
│   └─ 理解架構
│   └─ 識別核心模組
│   └─ 找出關鍵路徑
│
└─ 用 Claude Code 深入學習（3 小時）
    └─ 分析核心模組
    └─ 理解業務邏輯
    └─ 學習編碼規範

Day 2-7: 開始貢獻
├─ 用 Copilot 日常編碼（80% 時間）
│   └─ 快速學習團隊風格
│   └─ 提高編碼速度
│
└─ 用 Claude Code 複雜任務（20% 時間）
    └─ 跨模組功能開發
    └─ 程式碼審查學習
    └─ 文檔撰寫

總計：1 週從零到貢獻
```

**工具佔比**：
- Gemini CLI: 10%（Day 1 理解）
- Claude Code: 30%（深入學習）
- Copilot: 60%（日常編碼）

---

## 💰 成本效益分析

### 個人開發者

```
預算：$40/月

方案 A：全部採購
├─ Copilot: $10/月
├─ Claude Code: $20/月
├─ Gemini CLI: $5/月（按使用量）
└─ 總計: $35/月

方案 B：精簡配置
├─ Claude Code: $20/月（必選）
├─ Copilot: $10/月（推薦）
└─ 總計: $30/月

建議：方案 B
理由：Gemini CLI 使用頻率低，按需使用即可
```

### 小團隊（5 人）

```
預算：$200/月

方案 A：全員標配
├─ Copilot: $10 × 5 = $50/月
├─ Claude Code: $20 × 5 = $100/月
└─ 總計: $150/月

方案 B：分級配置
├─ 資深工程師（2 人）: Copilot + Claude Code = $60/月
├─ 中級工程師（2 人）: Copilot + Claude Code = $60/月
├─ 初級工程師（1 人）: Copilot only = $10/月
├─ Gemini CLI（團隊共用）: $20/月
└─ 總計: $150/月

建議：方案 A（全員標配）
理由：團隊效率提升 > 成本差異
```

### 中型團隊（20 人）

```
預算：$600/月

方案：分工配置
├─ 前端工程師（8 人）: Copilot only = $80/月
│   └─ 理由：主要日常編碼
│
├─ 後端工程師（8 人）: Copilot + Claude Code = $240/月
│   └─ 理由：需要深度分析與重構
│
├─ 架構師（2 人）: 全配 = $70/月
│   └─ 理由：需要全局視野
│
├─ Tech Lead（2 人）: 全配 = $70/月
│   └─ 理由：程式碼審查與架構設計
│
└─ 總計: $460/月

建議：採用，省 $140/月
```

---

## 🏆 最佳實踐

### 個人工具鏈設計

**新手開發者**：
```
階段 1（學習期，0-6 個月）:
└─ Copilot（必選）- 學習業界慣用寫法

階段 2（成長期，6-18 個月）:
├─ Copilot（日常）
└─ Claude Code（複雜任務）

階段 3（成熟期，18+ 個月）:
├─ Copilot（日常 60%）
├─ Claude Code（主力 35%）
└─ Gemini CLI（特定場景 5%）
```

**資深開發者**：
```
核心配置:
├─ Claude Code（主力工具，70%）
├─ Copilot（輔助編碼，25%）
└─ Gemini CLI（架構分析，5%）

使用策略:
- 複雜任務優先 Claude Code
- 簡單編碼使用 Copilot
- 新專案用 Gemini CLI 快速理解
```

---

### 團隊工具鏈設計

**原則 1：按職能配置**
```
前端工程師 → Copilot（80%）+ Claude Code（20%）
後端工程師 → Claude Code（60%）+ Copilot（40%）
全端工程師 → 平衡配置
架構師     → 全配置（需要所有視角）
```

**原則 2：按經驗配置**
```
Junior → Copilot（學習業界寫法）
Mid    → Copilot + Claude Code（深入能力）
Senior → 全配置（最大化效率）
```

**原則 3：按專案階段配置**
```
專案初期 → 重點配置 Gemini CLI（理解需求）
開發期   → 重點配置 Copilot（編碼效率）
重構期   → 重點配置 Claude Code（工作流程）
維護期   → 平衡配置
```

---

## 🎯 決策練習

### 練習 1：快速決策

為以下場景選擇工具（5 秒內）：

1. **場景**：寫一個 React 元件
   - 答案：______

2. **場景**：重構 100 個 API 的錯誤處理
   - 答案：______

3. **場景**：理解一個 50 萬行的舊專案
   - 答案：______

4. **場景**：為函數生成單元測試
   - 答案：______

5. **場景**：審查 Pull Request 的安全性
   - 答案：______

**參考答案**：
```
1. Copilot（單一元件，即時補全最快）
2. Claude Code（批量修改，工作流程編排）
3. Gemini CLI（巨量上下文，全局理解）
4. Copilot（測試生成，模式識別強）
5. Claude Code（/agents:security-auditor，深度分析）
```

---

### 練習 2：混合流程設計

**情境**：你要開發一個「使用者認證系統」（JWT、OAuth2、2FA）

設計混合工具流程：

```
你的設計：
1. _____________________________________________
2. _____________________________________________
3. _____________________________________________
4. _____________________________________________
5. _____________________________________________
```

**參考解答**：
```
1. 用 Claude Code 設計架構（15 分鐘）
   └─ 討論最佳實踐
   └─ 設計資料庫 schema
   └─ 規劃 API 端點

2. 用 Copilot 快速實作（45 分鐘）
   └─ 建立 User model
   └─ 實作 JWT 邏輯
   └─ 建立 OAuth2 endpoints

3. 用 Claude Code 安全審查（15 分鐘）
   └─ /agents:security-auditor
   └─ 檢查密碼處理
   └─ 驗證 token 安全性

4. 用 Copilot 生成測試（30 分鐘）
   └─ 單元測試
   └─ 整合測試
   └─ 安全測試案例

5. 用 Claude Code 生成文檔（15 分鐘）
   └─ API 文檔
   └─ 安全最佳實踐
   └─ 部署指南

總計：2 小時完成完整認證系統
```

---

## 📊 學習檢查點

完成本章後，驗證你是否掌握：

### 快速決策能力

- [ ] 能在 5 秒內為任意場景選擇工具
- [ ] 能說明選擇的 2-3 個關鍵理由
- [ ] 能識別何時需要混合使用

### 流程設計能力

- [ ] 能設計 3-5 步驟的混合工作流程
- [ ] 能評估每個工具的佔比
- [ ] 能優化流程以提升效率

### 成本意識

- [ ] 能計算工具採購的 ROI
- [ ] 能為團隊設計成本最優方案
- [ ] 理解按需使用 vs 固定訂閱的取捨

---

## 🎓 總結

### 黃金法則

1. **沒有最好的工具，只有最適合的工具**
   ```
   就像 Linux 命令：
   - 編輯小檔案用 nano（Copilot）
   - 複雜操作用 vim（Claude Code）
   - 分析目錄用 tree（Gemini CLI）
   ```

2. **混合使用效果最好**
   ```
   Copilot（60%）+ Claude Code（35%）+ Gemini CLI（5%）
   = 最高效率組合
   ```

3. **場景驅動選擇**
   ```
   不是「我有這個工具，我要用它」
   而是「這個場景，我該用什麼工具」
   ```

4. **持續優化工具鏈**
   ```
   每個月檢視:
   - 哪個工具用最多？
   - 哪個工具 ROI 最高？
   - 需要調整配置嗎？
   ```

---

**章節版本**：v1.0
**最後更新**：2025-01-30
**閱讀時間**：10 分鐘
**難度**：⭐⭐ 中等

**關鍵收穫**：
> 工具選擇 = 場景分析 + 成本考量 + 混合設計
> 快速決策法：三個問題（廣度？執行？頻率？）
> 最佳實踐：Copilot 60% + Claude Code 35% + Gemini 5%
> 持續優化，沒有完美方案
