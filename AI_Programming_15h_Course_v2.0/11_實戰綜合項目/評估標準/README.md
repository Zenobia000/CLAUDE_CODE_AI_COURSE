# 評估標準與自我檢查
# Assessment Rubric for Task Management System Project

**總分**: 100 分
**及格標準**: 70 分
**優秀標準**: 85 分

---

## 評分維度總覽

| 維度 | 分數 | 權重 | 關鍵指標 |
|-----|------|------|---------|
| 功能完整性 | 40 分 | 40% | 所有需求實現 |
| 代碼質量 | 20 分 | 20% | 測試、風格、結構 |
| 測試覆蓋 | 15 分 | 15% | 測試完整性 |
| 安全性 | 15 分 | 15% | 無漏洞、安全實踐 |
| 文檔與交付 | 10 分 | 10% | 文檔完整、可運行 |

---

## 1. 功能完整性 (40 分)

### 1.1 用戶管理功能 (12 分)

#### 1.1.1 用戶註冊 (4 分)
- [ ] **4 分**: 完整實現
  - ✅ 接受 email, password, username
  - ✅ Email 格式驗證
  - ✅ 密碼強度驗證（≥8 字元）
  - ✅ 防止重複 Email（409 錯誤）
  - ✅ 密碼加密存儲（bcrypt）
  - ✅ 返回用戶資訊（不含密碼）

- [ ] **3 分**: 基本功能正常，但缺少部分驗證
  - ✅ 能註冊
  - ❌ 缺少格式驗證或重複檢查

- [ ] **2 分**: 功能有嚴重缺陷
  - ✅ 能創建用戶
  - ❌ 密碼未加密或錯誤處理不足

- [ ] **0 分**: 功能不可用

**測試方法**:
```bash
# 成功註冊
curl -X POST http://localhost:8000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"SecurePass123","username":"Test User"}'
# 預期: 201, 返回用戶資訊

# 重複註冊
# 預期: 409, 錯誤訊息
```

---

#### 1.1.2 用戶登入 (4 分)
- [ ] **4 分**: 完整實現
  - ✅ 驗證憑證正確
  - ✅ 返回 JWT token
  - ✅ Token 包含 user_id 和過期時間
  - ✅ 錯誤憑證返回 401
  - ✅ Token 有效期配置正確（7 天）

- [ ] **3 分**: 基本功能正常，但 token 設計有缺陷
- [ ] **2 分**: 能登入但 token 驗證有問題
- [ ] **0 分**: 功能不可用

**測試方法**:
```bash
# 登入
curl -X POST http://localhost:8000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"SecurePass123"}'
# 預期: 200, 返回 token

# 錯誤密碼
# 預期: 401
```

---

#### 1.1.3 獲取當前用戶 (4 分)
- [ ] **4 分**: 完整實現
  - ✅ Token 驗證正確
  - ✅ 返回當前用戶資訊
  - ✅ 無效 token 返回 401
  - ✅ 過期 token 返回 401

- [ ] **2 分**: 基本功能正常，但驗證不嚴格
- [ ] **0 分**: 功能不可用

---

### 1.2 任務管理功能 (20 分)

#### 1.2.1 創建任務 (4 分)
- [ ] **4 分**: 完整實現
  - ✅ 需要認證
  - ✅ 接受所有必填欄位
  - ✅ 驗證優先級和狀態（Enum）
  - ✅ 自動設置 created_by 為當前用戶
  - ✅ 返回完整任務資訊

- [ ] **3 分**: 基本功能正常，但驗證不完整
- [ ] **0 分**: 功能不可用

**測試方法**:
```bash
curl -X POST http://localhost:8000/api/tasks \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"title":"Test Task","priority":"HIGH","due_date":"2025-11-05"}'
# 預期: 201, 返回任務
```

---

#### 1.2.2 查詢任務列表 (5 分)
- [ ] **5 分**: 完整實現
  - ✅ 需要認證
  - ✅ 默認只返回當前用戶的任務
  - ✅ 支援按狀態過濾
  - ✅ 支援按優先級過濾
  - ✅ 支援排序（created_at, due_date, priority）
  - ✅ 支援分頁（page, limit）
  - ✅ 返回分頁資訊（total, total_pages）

- [ ] **4 分**: 基本查詢和過濾功能正常
- [ ] **3 分**: 只有基本查詢，無過濾或分頁
- [ ] **0 分**: 功能不可用

**測試方法**:
```bash
# 基本查詢
curl -X GET http://localhost:8000/api/tasks \
  -H "Authorization: Bearer <token>"

# 過濾和排序
curl -X GET "http://localhost:8000/api/tasks?status=TODO&priority=HIGH&sort_by=due_date&page=1&limit=10" \
  -H "Authorization: Bearer <token>"
```

---

#### 1.2.3 查詢單一任務 (3 分)
- [ ] **3 分**: 完整實現
  - ✅ 需要認證
  - ✅ 返回完整任務資訊
  - ✅ 任務不存在返回 404
  - ✅ 無權限查看他人任務返回 403

- [ ] **2 分**: 基本功能正常，但權限檢查缺失
- [ ] **0 分**: 功能不可用

---

#### 1.2.4 更新任務 (4 分)
- [ ] **4 分**: 完整實現
  - ✅ 需要認證
  - ✅ 可以更新所有欄位（title, description, status, priority, due_date）
  - ✅ 只有任務創建者能更新
  - ✅ 無權限返回 403
  - ✅ 任務不存在返回 404
  - ✅ 自動更新 updated_at

- [ ] **3 分**: 基本功能正常，但權限檢查有漏洞
- [ ] **0 分**: 功能不可用

---

#### 1.2.5 刪除任務 (4 分)
- [ ] **4 分**: 完整實現
  - ✅ 需要認證
  - ✅ 只有任務創建者能刪除
  - ✅ 軟刪除（設置 is_deleted=True）
  - ✅ 無權限返回 403
  - ✅ 任務不存在返回 404
  - ✅ 返回 204 No Content

- [ ] **3 分**: 基本功能正常，但使用硬刪除
- [ ] **0 分**: 功能不可用

---

### 1.3 Dashboard 統計 (8 分)

#### 1.3.1 統計數據 API (8 分)
- [ ] **8 分**: 完整實現
  - ✅ 需要認證
  - ✅ 總任務數正確
  - ✅ 各狀態任務數正確（TODO, IN_PROGRESS, DONE）
  - ✅ 各優先級任務數正確
  - ✅ 即將到期任務數正確（7 天內）
  - ✅ 已逾期任務數正確
  - ✅ 只統計當前用戶的任務

- [ ] **6 分**: 基本統計正確，但缺少部分統計項
- [ ] **4 分**: 只有總數和狀態統計
- [ ] **0 分**: 功能不可用

**測試方法**:
```bash
curl -X GET http://localhost:8000/api/dashboard/stats \
  -H "Authorization: Bearer <token>"
# 驗證返回的數字是否正確
```

---

## 2. 代碼質量 (20 分)

### 2.1 代碼結構與組織 (7 分)

- [ ] **7 分**: 優秀
  - ✅ 清晰的目錄結構（models, schemas, routers, services 分離）
  - ✅ 單一職責原則（每個模組只負責一件事）
  - ✅ 沒有重複代碼（DRY 原則）
  - ✅ 函數長度合理（每個函數 < 50 行）
  - ✅ 使用依賴注入（FastAPI Depends）

- [ ] **5 分**: 良好
  - ✅ 基本結構合理
  - ❌ 有少量代碼重複或職責不清

- [ ] **3 分**: 及格
  - ✅ 能運行
  - ❌ 結構混亂或有明顯的壞味道

- [ ] **0 分**: 不及格（代碼結構嚴重混亂）

**檢查清單**:
- [ ] models/ 只包含 SQLAlchemy models
- [ ] schemas/ 只包含 Pydantic schemas
- [ ] routers/ 只包含 API endpoints（薄層）
- [ ] services/ 包含業務邏輯（厚層）
- [ ] utils/ 包含工具函數
- [ ] 沒有「上帝類」（God Class）或「上帝函數」

---

### 2.2 代碼風格與可讀性 (6 分)

- [ ] **6 分**: 優秀
  - ✅ 遵循 PEP 8
  - ✅ 使用 Type Hints
  - ✅ 有意義的變數和函數名稱
  - ✅ 適當的註解（解釋「為什麼」而非「是什麼」）
  - ✅ Docstrings 完整（函數、類）
  - ✅ 通過 Black 格式化
  - ✅ 通過 Flake8 檢查

- [ ] **4 分**: 良好
  - ✅ 基本遵循 PEP 8
  - ❌ 缺少部分 Type Hints 或註解

- [ ] **2 分**: 及格
  - ✅ 能理解代碼
  - ❌ 風格不一致或命名混亂

- [ ] **0 分**: 不及格（代碼難以閱讀）

**自動檢查**:
```bash
# Linting
flake8 app/ --max-line-length=100

# 格式化檢查
black --check app/

# Type checking (可選)
mypy app/
```

---

### 2.3 錯誤處理 (7 分)

- [ ] **7 分**: 優秀
  - ✅ 所有 API 都有適當的錯誤處理
  - ✅ 使用正確的 HTTP 狀態碼（400, 401, 403, 404, 409, 422, 500）
  - ✅ 錯誤訊息清晰且統一格式
  - ✅ 不洩漏敏感資訊（如堆疊追蹤）
  - ✅ 數據庫操作有事務處理
  - ✅ 異常捕獲適當（不過度也不遺漏）

- [ ] **5 分**: 良好
  - ✅ 基本錯誤處理完整
  - ❌ 錯誤訊息格式不一致

- [ ] **3 分**: 及格
  - ✅ 有錯誤處理
  - ❌ 狀態碼使用不當或訊息不清

- [ ] **0 分**: 不及格（缺少錯誤處理，容易崩潰）

**檢查點**:
- [ ] 驗證失敗 → 422
- [ ] 認證失敗 → 401
- [ ] 權限不足 → 403
- [ ] 資源不存在 → 404
- [ ] 資源衝突（如重複 Email） → 409
- [ ] 伺服器錯誤 → 500

---

## 3. 測試覆蓋 (15 分)

### 3.1 測試覆蓋率 (8 分)

- [ ] **8 分**: ≥ 80% 覆蓋率
  - ✅ 所有關鍵路徑有測試
  - ✅ 覆蓋 models, services, routers

- [ ] **6 分**: 70-79% 覆蓋率
- [ ] **4 分**: 60-69% 覆蓋率
- [ ] **2 分**: 50-59% 覆蓋率
- [ ] **0 分**: < 50% 覆蓋率

**檢查方法**:
```bash
pytest --cov=app --cov-report=term --cov-report=html
# 查看 htmlcov/index.html
```

---

### 3.2 測試質量 (7 分)

- [ ] **7 分**: 優秀
  - ✅ 所有 API endpoints 有測試
  - ✅ 測試覆蓋成功案例和失敗案例
  - ✅ 測試邊界條件
  - ✅ 測試權限控制
  - ✅ 測試數據隔離（每個測試獨立）
  - ✅ 測試命名清晰（test_xxx_should_yyy）
  - ✅ 使用 fixtures 避免重複

- [ ] **5 分**: 良好
  - ✅ 主要功能有測試
  - ❌ 缺少部分邊界測試或錯誤案例

- [ ] **3 分**: 及格
  - ✅ 有基本測試
  - ❌ 測試不完整或質量低

- [ ] **0 分**: 無測試或測試無法運行

**關鍵測試案例清單**:

**用戶認證**:
- [ ] test_register_success
- [ ] test_register_duplicate_email
- [ ] test_register_invalid_email
- [ ] test_register_weak_password
- [ ] test_login_success
- [ ] test_login_wrong_password
- [ ] test_login_nonexistent_user
- [ ] test_get_current_user_valid_token
- [ ] test_get_current_user_invalid_token

**任務管理**:
- [ ] test_create_task_success
- [ ] test_create_task_missing_required_field
- [ ] test_list_tasks_success
- [ ] test_list_tasks_filter_by_status
- [ ] test_list_tasks_filter_by_priority
- [ ] test_list_tasks_pagination
- [ ] test_get_task_success
- [ ] test_get_task_not_found
- [ ] test_get_task_permission_denied
- [ ] test_update_task_success
- [ ] test_update_task_permission_denied
- [ ] test_delete_task_success
- [ ] test_delete_task_permission_denied

**Dashboard**:
- [ ] test_dashboard_stats_accuracy

---

## 4. 安全性 (15 分)

### 4.1 認證與授權 (6 分)

- [ ] **6 分**: 完整實現
  - ✅ 密碼使用 bcrypt 加密（cost factor ≥ 12）
  - ✅ JWT token 包含必要資訊（user_id, exp）
  - ✅ Token 有效期設置合理（7 天）
  - ✅ 所有需要認證的 API 都有保護
  - ✅ 權限檢查嚴格（用戶只能操作自己的資源）
  - ✅ 不在響應中返回密碼

- [ ] **4 分**: 基本安全
  - ✅ 密碼加密
  - ✅ 有認證機制
  - ❌ 部分權限檢查缺失

- [ ] **0 分**: 有嚴重安全漏洞

**安全檢查清單**:
- [ ] 密碼不以明文存儲
- [ ] JWT secret 從環境變數讀取（不寫死在代碼中）
- [ ] 用戶 A 無法查看/修改用戶 B 的任務

---

### 4.2 輸入驗證與 SQL 注入防護 (5 分)

- [ ] **5 分**: 完整防護
  - ✅ 所有輸入使用 Pydantic 驗證
  - ✅ 使用 ORM (SQLAlchemy) 防止 SQL 注入
  - ✅ 沒有直接拼接 SQL 語句
  - ✅ 驗證資料類型和格式（email, enum 等）
  - ✅ 限制字串長度（防止 DoS）

- [ ] **3 分**: 基本驗證
  - ✅ 使用 ORM
  - ❌ 部分輸入缺少驗證

- [ ] **0 分**: 有 SQL 注入風險或缺少輸入驗證

**檢查方法**:
```bash
# SQL 注入測試（應該失敗或被攔截）
curl -X POST http://localhost:8000/api/auth/login \
  -d '{"email":"admin@example.com OR 1=1--","password":"anything"}'
# 預期: 422 或 401，不應該成功登入
```

---

### 4.3 安全掃描 (4 分)

- [ ] **4 分**: 通過所有掃描
  - ✅ Bandit 掃描無 medium/high 問題
  - ✅ Safety check 無已知漏洞依賴
  - ✅ CORS 配置正確（不使用 `*` in production）
  - ✅ 環境變數不洩漏在代碼中

- [ ] **2 分**: 有少量 low 等級問題
- [ ] **0 分**: 有 critical/high 等級問題

**自動掃描**:
```bash
# Bandit (安全 linter)
bandit -r app/ -ll

# Safety (依賴漏洞)
safety check

# 預期: 無 critical/high 等級問題
```

---

## 5. 文檔與交付 (10 分)

### 5.1 API 文檔 (4 分)

- [ ] **4 分**: 完整且清晰
  - ✅ Swagger UI 可訪問 (http://localhost:8000/docs)
  - ✅ 所有 endpoints 有描述
  - ✅ 包含請求/響應示例
  - ✅ 錯誤碼說明清楚
  - ✅ 認證要求標示清楚

- [ ] **3 分**: 基本完整但缺少部分說明
- [ ] **2 分**: 只有自動生成的文檔，無額外說明
- [ ] **0 分**: 無文檔或無法訪問

---

### 5.2 README 與部署文檔 (4 分)

- [ ] **4 分**: 完整且專業
  - ✅ README 包含:
    - 專案簡介
    - 功能列表
    - 技術棧
    - 安裝步驟（可執行）
    - 運行步驟
    - 測試指令
    - API 文檔連結
  - ✅ 部署文檔清晰（Docker 或雲平台）
  - ✅ 環境變數說明完整

- [ ] **3 分**: 基本文檔完整
- [ ] **2 分**: 文檔不完整或有錯誤
- [ ] **0 分**: 無文檔

---

### 5.3 可運行性 (2 分)

- [ ] **2 分**: 開箱即用
  - ✅ 按照 README 步驟可以成功運行
  - ✅ 不需要額外配置或猜測
  - ✅ Docker Compose 一鍵啟動

- [ ] **1 分**: 需要少量調整才能運行
- [ ] **0 分**: 無法運行或缺少關鍵文件

---

## 評分總結表

### 快速自我評估

| 維度 | 自評分數 | 滿分 | 達標？ |
|-----|---------|------|-------|
| 功能完整性 | ___ / 40 | 40 | ≥28 ✅ |
| 代碼質量 | ___ / 20 | 20 | ≥14 ✅ |
| 測試覆蓋 | ___ / 15 | 15 | ≥10 ✅ |
| 安全性 | ___ / 15 | 15 | ≥10 ✅ |
| 文檔與交付 | ___ / 10 | 10 | ≥7 ✅ |
| **總分** | ___ / 100 | 100 | ≥70 ✅ |

---

## 等級標準

| 總分範圍 | 等級 | 說明 |
|---------|------|------|
| 90-100 | A+ 優秀 | 超越企業標準，可直接用於生產環境 |
| 85-89 | A 優秀 | 達到企業標準，質量很高 |
| 80-84 | B+ 良好 | 功能完整，質量良好 |
| 75-79 | B 良好 | 基本達標，有改進空間 |
| 70-74 | C 及格 | 勉強及格，需要改進 |
| < 70 | F 不及格 | 不符合最低標準，需要重做 |

---

## Peer Review 檢查清單

### 如果你要找同學互評，使用這個清單：

**功能測試** (30 min):
- [ ] 能成功註冊和登入
- [ ] 能創建、查看、更新、刪除任務
- [ ] Dashboard 統計數據正確
- [ ] 無法操作他人的任務
- [ ] 錯誤處理友善

**代碼審查** (30 min):
- [ ] 代碼結構清晰
- [ ] 沒有明顯的代碼壞味道
- [ ] 測試覆蓋關鍵功能
- [ ] 有適當的註解

**文檔檢查** (10 min):
- [ ] README 清晰，可以按步驟運行
- [ ] API 文檔完整

**總體評價**:
- 優點: ___
- 需改進: ___
- 建議: ___

---

## 改進建議

### 如果你的分數 < 70

**優先改進項目**:
1. 確保所有 API 功能完整（功能完整性 ≥28 分）
2. 補充缺少的測試案例（測試覆蓋 ≥10 分）
3. 修復安全漏洞（安全性 ≥10 分）

### 如果你的分數 70-84

**提升到 A 的方法**:
1. 提高測試覆蓋率到 80%+
2. 改善代碼結構和命名
3. 增強 API 文檔
4. 添加 CI/CD

### 如果你的分數 ≥85

**挑戰進階**:
1. 部署到雲端平台
2. 添加監控與日誌
3. 實作進階功能（見「進階擴展」）
4. 寫技術文章分享

---

**記住**: 這個評分標準不是為了「打分數」，而是幫助你系統化地檢視專案質量，找到改進方向。

完成專案後，誠實地給自己打分，然後針對弱項改進。這才是真正的成長！ 🚀
